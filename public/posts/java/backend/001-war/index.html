<!DOCTYPE html>
<html lang="en">
<head>
  
    
    <title>æ‰‹åŠ¨éƒ¨ç½² War åŒ…åˆ° Tomcat ä¹‹ä½•ä¸º War :: ä¸ºéœœçš„åšå®¢</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Web application resources or web application archives are commonly called WAR files. A WAR file is used to deploy a Java EE web application in an application server. Inside a WAR file, all the web components are packed into one single unit. These include JAR files, JavaServer Pages, Java servlets, Java class files, XML files, HTML files, and other resource files that we need for web applications. We can use the Maven WAR plugin to build our project as a WAR file.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://blog.jiyi27.com/posts/java/backend/001-war/" />





  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/categories.min.3202f75cbb294747099af3850a68a09ee94b3ce505fc39e134692d90ff0a9b2a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/code.min.dd73d157e77e82a3dc1cb06ba424cf6cc6811af0bb604ad6c68e70faf2439c8a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/main.min.3fb8954e26342ad3afabb4525959bfec6f9fc0d6929f0dda738ddeee30211690.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/menu.min.8cee75f73b9f9b1e40bd0dd53e6e770156b08bbfe1c579cd256c3f6cd3b6d32b.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/post.min.014a50745fbdd41d5f420a3e288730d5af4b7d90344dc6211d0e50c368b5b303.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/prism.min.b958d3d7c6c67361b945f9062d07d403422604b3d2cd33f93b88d41ed0ba634d.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/term.min.94de320c1b850e126e6d2c88a7c90acf58bb1313f0ea14a14cda2a42f2a88db2.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="https://blog.jiyi27.com/terminal.css">




<link rel="shortcut icon" href="https://blog.jiyi27.com/favicon.png">
<link rel="apple-touch-icon" href="https://blog.jiyi27.com/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="æ‰‹åŠ¨éƒ¨ç½² War åŒ…åˆ° Tomcat ä¹‹ä½•ä¸º War">
<meta property="og:description" content="Web application resources or web application archives are commonly called WAR files. A WAR file is used to deploy a Java EE web application in an application server. Inside a WAR file, all the web components are packed into one single unit. These include JAR files, JavaServer Pages, Java servlets, Java class files, XML files, HTML files, and other resource files that we need for web applications. We can use the Maven WAR plugin to build our project as a WAR file.
" />
<meta property="og:url" content="https://blog.jiyi27.com/posts/java/backend/001-war/" />
<meta property="og:site_name" content="ä¸ºéœœçš„åšå®¢" />

  <meta property="og:image" content="https://blog.jiyi27.com/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="spring boot" />


  <meta property="article:published_time" content="2023-04-27 21:30:48 &#43;0000 UTC" />












</head>
<body>


<div class="container center">

  
  
  

  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://blog.jiyi27.com/posts/java/backend/001-war/">æ‰‹åŠ¨éƒ¨ç½² War åŒ…åˆ° Tomcat ä¹‹ä½•ä¸º War</a>
  </h1>
  <div class="post-meta"><time class="post-date">2023-04-27</time><span class="post-reading-time">5 åˆ†é’Ÿé˜…è¯» (961 å­—æ•°)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://blog.jiyi27.com/tags/spring-boot/">spring boot</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>Web application resources or web application archives are commonly called WAR files. A WAR file is used to deploy a Java EE web application in an application server. Inside a WAR file, all the web components are packed into one single unit. These include JAR files, JavaServer Pages, Java servlets, Java class files, XML files, HTML files, and other resource files that we need for web applications. We can use the Maven WAR plugin to build our project as a <a href="https://www.baeldung.com/java-jar-war-packaging#war">WAR</a> file.</p>
<h2 id="1-add-a-new-user-with-deployment-rights-to-tomcat">1. Add a new user with deployment rights to Tomcat<a href="#1-add-a-new-user-with-deployment-rights-to-tomcat" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>To perform a Maven Tomcat deploy of a <code>WAR</code> file you must first set up a <strong>user</strong> in Tomcat with the appropriate rights. You can do this with an edit of the <code>tomcat-users.xml</code> file, which can be found in Tomcat&rsquo;s <code>conf</code> sub-directory. Add the following entry <strong>inside</strong> the <code>tomcat-users</code> tag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;user</span> <span style="color:#a6e22e">username=</span><span style="color:#e6db74">&#34;war-deployer&#34;</span> <span style="color:#a6e22e">password=</span><span style="color:#e6db74">&#34;maven-tomcat-plugin&#34;</span> <span style="color:#a6e22e">roles=</span><span style="color:#e6db74">&#34;manager-gui, manager-script, manager-jmx&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span></code></pre></div><p>Save the tomcat-users.xml file and restart the server to have the changes take effect.</p>
<p>é‡å¯Tomcatå°±æ˜¯è¿›åˆ°Tomcatçš„<code>bin</code>ç›®å½•ä¸‹, æ‰§è¡Œ<code>startup.sh</code>, <code>./shutdown.sh</code>, å…¶å®ä½ ç›´æ¥ä½¿ç”¨<code>startup.sh</code>å‘½ä»¤å¼€å¯TomcatæœåŠ¡å°±ä¼šåŠ è½½é…ç½®æ–‡ä»¶äº†, ä¸Šé¢è¯´çš„é‡å¯æ˜¯é»˜è®¤ä½ çš„Tomcatä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€. ç°åœ¨ä½ ä¹Ÿåº”è¯¥å¯åŠ¨TomcatæœåŠ¡äº†, å¯åŠ¨åå°è¯•è®¿é—®<code>http://localhost:8080/</code>,</p>
<p><img src="/war/d.png" alt=""></p>
<p>ç‚¹å‡»åè¾“å…¥ä¸Šé¢çš„<code>username</code>å’Œå¯¹åº”çš„<code>password</code>, å³å¯è¿›å…¥ç®¡ç†é¡µé¢å¦‚ä¸‹:</p>
<p><img src="/war/e.png" alt=""></p>
<p><strong>æ— æ³•è®¿é—® tomcat ä¸»é¡µé—®é¢˜</strong></p>
<p>æˆ‘åœ¨è®¿é—®Tomcatä¸»é¡µå‡ºç°äº†é—®é¢˜, è®¿é—®çš„æ€»æ˜¯æˆ‘ä»¥å‰çš„JSPåº”ç”¨, æˆ‘ç”¨IDEAå¼€å‘çš„, ä½†æˆ‘éƒ½æ²¡æ‰“å¼€IDEA, ä»ç„¶å¯ä»¥è®¿é—®åˆ°, å¦‚ä¸‹:</p>
<p><img src="/war/a.png" alt=""></p>
<p>ç„¶åæˆ‘å°±<a href="https://www.cnblogs.com/yayazi/p/7920257.html">æŸ¥åˆ°äº†ä¸€ä¸ªåšå®¢</a>è¯´éœ€è¦å°†Tomcatçš„é¦–é¡µçš„å·¥ç¨‹éƒ¨ç½²åˆ°TomcatæœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬é€šè¿‡IDEAæ¥æ“ä½œ, éƒ¨ç½²æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p>é€‰æ‹©èœå•æ â€œRun&ndash;&gt;Edit Configuration&hellip;&ndash;&gt;Deploymentâ€, é€‰æ‹©å³ä¸Šè§’ç»¿è‰²â€œ+â€ï¼Œé€‰æ‹©â€œExternal Source&hellip;â€ï¼Œå°†Apache-tomcatçš„<code>webapps</code>ç›®å½•ä¸‹çš„ROOTæ–‡ä»¶å¤¹æ·»åŠ è¿›æ¥, ä¸‹é¢çš„Application Context ç©ºç€, åˆ é™¤ <code>ROOT</code> ä¸‹é¢çš„é‚£ä¸ª<code>ServletDemo:war exploded</code>, å¦‚ä¸‹å›¾:</p>
<p><img src="/war/b.png" alt=""></p>
<p>ç„¶åæˆ‘IDEAä¸Šé€‰æ‹©çš„TomcatæœåŠ¡å™¨ä¸æ˜¯æˆ‘ç°åœ¨ç”¨çš„, æˆ‘æœ‰ä¸ªæ—§çš„TomcatæœåŠ¡å™¨, æˆ‘ä¸çŸ¥é“, ç„¶åIDEAç”¨çš„ä¸€ç›´æ˜¯é‚£ä¸ªæ—§çš„(ä½†æˆ‘åœ¨ä¸Šé¢éƒ¨ç½²ä½ç½®çš„<code>ROOT</code>æ–‡ä»¶å¤¹é€‰æ‹©çš„æ˜¯æ–°çš„Tomcatä¸‹çš„æ–‡ä»¶), æ‰€ä»¥å°±å¯¼è‡´å°±ç®—éƒ¨ç½²é¡¹ç›®å, æˆ‘ä¾ç„¶æ— æ³•è®¿é—®Tomcatçš„ä¸»é¡µ. æ‰€ä»¥æ£€æŸ¥ä¸€ä¸‹ä½ æ˜¯å¦é€‰æ‹©äº†æ­£ç¡®çš„TomcatæœåŠ¡å™¨,</p>
<p><img src="/war/c.png" alt=""></p>
<p>è¿™æ ·é…ç½®å¥½åå†åœ¨IDEAç‚¹å‡»è¿è¡Œ, å°±å¯ä»¥é€šè¿‡<code>http://localhost:8080/</code>è®¿é—® Tomcat ä¸»é¡µäº†, ä¹‹åä½ å…³é—­IDEA, ç›´æ¥è¿›å…¥Tomcatæ ¹ç›®å½•çš„<code>bin</code>ä¸‹é€šè¿‡æ‰§è¡Œ<code>startup.sh</code>æ¥å¯åŠ¨Tomcat.</p>
<p>æœ‰æ—¶å€™ä½ ä¼šé‡åˆ°å…¶ä»–æƒ…å†µ, æ¯”å¦‚8080ç«¯å£è¢«å ç”¨, è¿™æ—¶å€™è§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># æŸ¥çœ‹PID</span>
</span></span><span style="display:flex;"><span>lsof -n -i4TCP:8080 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ é™¤8080ç«¯å£å¯¹åº”çš„PID</span>
</span></span><span style="display:flex;"><span>kill -9 PID
</span></span></code></pre></div><p>è¯´äº†é‚£ä¹ˆå¤šç»ˆäºè¦è¿›è¡Œä¸‹ä¸€æ­¥äº†,</p>
<h2 id="2-tell-maven-about-the-tomcat-deploy-user">2. Tell Maven about the Tomcat deploy user<a href="#2-tell-maven-about-the-tomcat-deploy-user" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>After you add the <code>war-deployer</code> user to Tomcat, register that <code>username</code> and <code>password</code> in Maven, along with a named reference to the server. The Maven-Tomcat plugin will use this information when it tries to <a href="https://www.theserverside.com/feature/Is-Apache-Tomcat-the-right-Java-application-server-for-you">connect to the application server</a>. Edit the <code>settings.xml</code> file and add the following entry <strong>within</strong> the <code>&lt;server&gt;</code> tag to create the named reference to the server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- Configure the Tomcat Maven plugin user --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;server&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;id&gt;</span>maven-tomcat-war-deployment-server&gt;<span style="color:#f92672">&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;username&gt;</span>war-deployer<span style="color:#f92672">&lt;/username&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;password&gt;</span>maven-tomcat-plugin<span style="color:#f92672">&lt;/password&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/server&gt;</span>
</span></span></code></pre></div><blockquote>
<p>æ³¨æ„, ä¸Šé¢æåˆ°çš„<code>settings.xml</code>æ–‡ä»¶åœ¨<code>Downloads/apache-maven-3.9.1/conf</code>ä¸‹, æ ¹æ®ä½ çš„mavenå®‰è£…ç›®å½•æŸ¥æ‰¾,</p>
<p>å¦å¤–è¿™é‡ŒåŠ çš„è´¦å·å¯†ç å°±æ˜¯ä¸Šé¢åœ¨Tomcatæ·»åŠ ç”¨æˆ·æ—¶å€™çš„è´¦å·å¯†ç , è¿™æ˜¯å› ä¸ºä½ è¿›å…¥Tomcatç®¡ç†é¡µé¢çš„æ—¶å€™éœ€è¦,å¦‚æœä½ ä¸æä¾›(ä¸‹é¢é…ç½®<code>pom.xml</code>ä¹Ÿä¼šè¯´åˆ°), é‚£ç”Ÿæˆwaræ–‡ä»¶çš„æ—¶å€™mavenå°±ä¼šæŠ¥é”™,</p>
</blockquote>
<h2 id="3-register-the-tomcat7-maven-plugin-in-the-pom">3. Register the tomcat7-maven-plugin in the POM<a href="#3-register-the-tomcat7-maven-plugin-in-the-pom" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>æŠŠæ‰“åŒ…æ ¼å¼æ”¹æˆ<code>war</code>, å³åœ¨<code>pom.xml</code>ä¸­æ‰¾åˆ°<code>&lt;packaging&gt;</code>æ ‡ç­¾, æ²¡æœ‰çš„è¯æ·»åŠ ä¸€ä¸ª, ä¸<code>&lt;dependencies&gt;</code>æ ‡ç­¾å¹¶åˆ—:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;groupId&gt;</span>com.example<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;artifactId&gt;</span>ServletDemo<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;name&gt;</span>ServletDemo<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;packaging&gt;</span>war<span style="color:#f92672">&lt;/packaging&gt;</span>
</span></span></code></pre></div><p>Now that Maven and Tomcat are configured, the next step is to edit the Java web application&rsquo;s POM file to reference the Tomcat Maven plugin.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;groupId&gt;</span>org.apache.tomcat.maven<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;version&gt;</span>2.0<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;url&gt;</span>http://localhost:8080/manager/text<span style="color:#f92672">&lt;/url&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;path&gt;</span>/rps<span style="color:#f92672">&lt;/path&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span></code></pre></div><p>è¿è¡Œ<code>mvn install tomcat7:deploy</code>ç”Ÿæˆwarçš„æ—¶å€™æ€»æ˜¯æŠ¥é”™(å¦‚æœä½ ä¹‹å‰å·²ç»ç”Ÿæˆäº†Waræ–‡ä»¶, è¯·è®°å¾—å»Tomcatæ ¹ç›®å½•ä¸‹çš„<code>webapp</code>ç›®å½•ä¸‹åˆ é™¤ä¸€ç”Ÿæˆçš„waræ–‡ä»¶, å¦åˆ™ä¹Ÿä¼šæŠ¥é”™, å’Œä¸‹é¢ä¸€æ ·):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> Failed to execute goal org.apache.tomcat.maven:tomcat7-maven-plugin:2.0:deploy <span style="color:#f92672">(</span>default-cli<span style="color:#f92672">)</span> on project ServletDemo: Cannot invoke Tomcat manager: Broken pipe -&gt; <span style="color:#f92672">[</span>Help 1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> To see the full stack trace of the errors, re-run Maven with the -e switch.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> Re-run Maven using the -X switch to enable full debug logging.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> For more information about the errors and possible solutions, please read the following articles:
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Help 1<span style="color:#f92672">]</span> http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException
</span></span></code></pre></div><p>åŠ å…¥æˆ‘ä»¬åœ¨Tomcat Usersé‡Œé…ç½®çš„è´¦å·å¯†ç :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;groupId&gt;</span>org.apache.tomcat.maven<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;version&gt;</span>2.0<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;url&gt;</span>http://localhost:8080/manager/text<span style="color:#f92672">&lt;/url&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;path&gt;</span>/rps<span style="color:#f92672">&lt;/path&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;username&gt;</span>war-deployer<span style="color:#f92672">&lt;/username&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;password&gt;</span>maven-tomcat-plugin<span style="color:#f92672">&lt;/password&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span></code></pre></div><blockquote>
<p>æ³¨æ„: ä¿®æ”¹<code>pom.xml</code>åéœ€è¦æ›´æ–°<code>pom.xml</code></p>
<p>æç¤º: ç‚¹å‡»IDEAè½¯ä»¶çš„å³ä¸Šè§’æœ‰ä¸ªæµ®åŠ¨çš„æ›´æ–°å°æŒ‰é’®å³æ›´æ–°, æˆ–è€…ä½ å¯ä»¥æŸ¥æŸ¥å‘½ä»¤è¡Œmavenæ€ä¹ˆæ›´æ–°<code>pom.xml</code>æ–‡ä»¶.</p>
</blockquote>
<p>ç„¶åé‡æ–°è¿è¡Œ<code>mvn install tomcat7:deploy</code>, æˆåŠŸ:</p>
<p><img src="/war/f.png" alt=""></p>
<p>ç„¶åå»Tomcatæ ¹ç›®å½•çš„<code>webapps</code>ä¸‹æŸ¥çœ‹ç”Ÿæˆçš„War, å¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†åä¸º<code>rps</code>çš„webåº”ç”¨, å³è¿™ä¸ªåå­—å–å†³äºä¸Šé¢<code>pom.xml</code>å¡«çš„å†…å®¹,</p>
<p><img src="/war/g.png" alt=""></p>
<p>ç„¶åæˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹ç”Ÿæˆçš„warä¸æˆ‘ä»¬çš„æºä»£ç æ–‡ä»¶ç»“æ„:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#æºä»£ç </span>
</span></span><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>â”œâ”€â”€ pom.xml
</span></span><span style="display:flex;"><span>â”œâ”€â”€ src
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ main
</span></span><span style="display:flex;"><span>â”‚Â Â      â”œâ”€â”€ java
</span></span><span style="display:flex;"><span>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ database
</span></span><span style="display:flex;"><span>â”‚Â Â      â”‚Â Â  â””â”€â”€ servlet
</span></span><span style="display:flex;"><span>â”‚Â Â      â”œâ”€â”€ resources
</span></span><span style="display:flex;"><span>â”‚Â Â      â”‚Â Â  â””â”€â”€ log4j.properties
</span></span><span style="display:flex;"><span>â”‚Â Â      â””â”€â”€ webapp
</span></span><span style="display:flex;"><span>â”‚Â Â          â”œâ”€â”€ WEB-INF
</span></span><span style="display:flex;"><span>â”‚Â Â          â”œâ”€â”€ hello.jsp
</span></span><span style="display:flex;"><span>â”‚Â Â          â””â”€â”€ index.jsp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># War</span>
</span></span><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>â”œâ”€â”€ META-INF
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ MANIFEST.MF
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ maven
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ com.example
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â      â””â”€â”€ ServletDemo
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ war-tracker
</span></span><span style="display:flex;"><span>â”œâ”€â”€ WEB-INF
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ classes
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ database
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Controller.class
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ DataEntity.class
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Database.class
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ MysqlDatabase.class
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ log4j.properties
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ servlet
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ GetDataServlet$1.class
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ GetDataServlet.class
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ test
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ lib
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ gson-2.9.0.jar
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ log4j-1.2.17.jar
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ mysql-connector-j-8.0.32.jar
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ protobuf-java-3.21.9.jar
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ web.xml
</span></span><span style="display:flex;"><span>â”œâ”€â”€ hello.jsp
</span></span><span style="display:flex;"><span>â””â”€â”€ index.jsp
</span></span></code></pre></div><p>å¯¹äºç”Ÿæˆçš„Waræ–‡ä»¶å¯ä»¥å‘ç°æ‰€æœ‰Javaç›¸å…³çš„æ–‡ä»¶éƒ½åœ¨<code>WEB-INF</code>ä¸‹, æ¯”å¦‚æˆ‘ä»¬ç¼–å†™çš„Servletå­—èŠ‚ç æ–‡ä»¶å’Œå’Œæˆ‘ä»¬ç”¨åˆ°çš„ä¾èµ–(gson, mysql connector, log4j). ç„¶åä»”ç»†çœ‹æºä»£ç æ–‡ä»¶ç»“æ„, åœ¨<code>webapp</code>ä¸‹ä¹Ÿæœ‰ä¸ª<code>WEB-INF</code>, è¿™ä¸‹é¢æ”¾çš„å°±æ˜¯æˆ‘ä»¬é¡¹ç›®çš„<code>web.xml</code>, å†…å®¹å¦‚ä¸‹(æ‰€ä»¥è¿™æœ‰ä»€ä¹ˆè”ç³»å‘¢),</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;web-app</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://xmlns.jcp.org/xml/ns/javaee&#34;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&#34;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">version=</span><span style="color:#e6db74">&#34;4.0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;welcome-file-list&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;welcome-file&gt;</span>/index.jsp<span style="color:#f92672">&lt;/welcome-file&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/welcome-file-list&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;servlet&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;servlet-name&gt;</span>get-data<span style="color:#f92672">&lt;/servlet-name&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;servlet-class&gt;</span>servlet.GetDataServlet<span style="color:#f92672">&lt;/servlet-class&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/servlet&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;servlet-mapping&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;servlet-name&gt;</span>get-data<span style="color:#f92672">&lt;/servlet-name&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;url-pattern&gt;</span>/temperature/*<span style="color:#f92672">&lt;/url-pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;url-pattern&gt;</span>/humidity/*<span style="color:#f92672">&lt;/url-pattern&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/servlet-mapping&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/web-app&gt;</span>
</span></span></code></pre></div><h2 id="4-verify">4. Verify<a href="#4-verify" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>ç¡®ä¿ä½ å·²ç»å¼€å¯TomcatæœåŠ¡(å³ä½¿ä½ å…³é—­äº†IDEA, IDEAå’ŒTomcatæ˜¯ä¸¤ä¸ªä¸œè¥¿, IDEAæ˜¯ä¸ªIDEä¼šç”¨åˆ°Tomcatä½œä¸ºwebæœåŠ¡å™¨æ¥éƒ¨ç½²web app), ç„¶åè®¿é—®é€šè¿‡<code>http://localhost:8080/</code>è®¿é—®åˆ°Tomcatä¸»é¡µ, è¿™æ—¶å€™ä½ å¯ä»¥åœ¨é“¾æ¥ğŸ”—ååŠ ä¸Š<code>/rps</code>å³<code>http://localhost:8080/rps/</code>å°±å¯ä»¥è¿›å…¥åˆ°ä½ çš„é‚£ä¸ªwebç½‘é¡µ, å¦‚ä¸‹:</p>
<p><img src="/war/h.png" alt=""></p>
<h2 id="5-æ€è€ƒæ€»ç»“">5. æ€è€ƒæ€»ç»“<a href="#5-æ€è€ƒæ€»ç»“" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>è¿™æ—¶å€™å…¶å®æˆ‘ä»¬ä¹Ÿå°±çŸ¥é“äº†ä»€ä¹ˆæ˜¯æ ¹ç›®å½•å’Œurlä¸­ç¥ç§˜çš„è·¯å¾„é—®é¢˜, ä½ çœ‹æˆ‘ä»¬è‹¥æƒ³è®¿é—®<code>manager</code>é¡µé¢, è¿™ä¸ªé¡µé¢çš„urlæ˜¯<code>http://localhost:8080/manager/</code>, æˆ‘ä»¬è®¿é—®æˆ‘ä»¬åˆšéƒ¨ç½²çš„é¡µé¢æ˜¯<code>http://localhost:8080/rps/</code>, ä½ çœ‹æœ€åçš„è¿™ä¸ªè·¯å¾„åŠ<code>/manager</code>, <code>/rps</code>éƒ½æ˜¯tomcatçš„<code>webapps</code>ç›®å½•ä¸‹çš„æ–‡ä»¶, å¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># David @ tc0db in ~/Downloads/Programs/apache-tomcat-9.0.73/webapps</span>
</span></span><span style="display:flex;"><span>$ ls
</span></span><span style="display:flex;"><span>ROOT         examples     manager      rps.war
</span></span><span style="display:flex;"><span>docs         host-manager rps
</span></span></code></pre></div><p>æ‰€ä»¥<code>webapp</code>å°±æ˜¯æ‰€è°“çš„æ ¹ç›®å½•, æˆ‘ä»¬è®¿é—®ä»€ä¹ˆéƒ½æ˜¯æ ¹æ®å®ƒæ¥çš„, å¯ä»¥çœ‹åˆ°, <code>webapps</code>ç›®å½•ä¸‹è¿˜æœ‰<code>examples</code>ç­‰æ–‡ä»¶å¤¹, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡<code>http://localhost:8080/example/</code>è®¿é—®. ä½†æ˜¯åˆæœ‰ä¸ªé—®é¢˜, Tomcatçš„ä¸»é¡µä¹Ÿå°±æ˜¯æ˜¯<code>http://localhost:8080/</code>å…·ä½“åœ¨å“ªå‘¢? æŒ‰ç†è¯´<code>webapps</code>ä¸‹åº”è¯¥æœ‰ä¸ª<code>index.html</code>æ–‡ä»¶å‘€, å¯æ˜¯å´ç©ºç©º, è¿™æ˜¯æ€ä¹ˆå›äº‹, æ€ä¹ˆæ²¡æœ‰æŒ‰æˆ‘ä»¬ä¸Šé¢æ¨å¯¼çš„è·¯å¾„æ¥å‘¢?</p>
<p>è¿˜è®°ä¸è®°å¾—å½“æ—¶å­¦ä¹ servletçš„æ—¶å€™æœ‰ä¸ª<code>web.xml</code>æ–‡ä»¶, æˆ‘ä»¬åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œå¯ä»¥é…ç½®ä¸ªwelcomeæ ‡ç­¾, é€šè¿‡è¿™ä¸ªæ ‡ç­¾æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æŒ‡å®šä¸€ä¸ªhtmlæ–‡ä»¶ä½œä¸ºæˆ‘ä»¬çš„ä¸»é¡µè€Œä¸æ˜¯æ ¹ç›®å½•ä¸‹çš„<code>index.tml</code>æ–‡ä»¶, åŒæ ·, Tomcatå½“ç„¶ä¹Ÿæœ‰è¿™ä¸ªæ–‡ä»¶ <code>TOMCAT_HOME/conf/web.xml</code>, æœç´¢<code>welcome</code>æ‰¾åˆ°å•¦(åœ¨<code>tomcat/webapps/ROOT/index.jsp</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- ==================== Default Welcome File List ===================== --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- When a request URI refers to a directory, the default servlet looks  --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- for a &#34;welcome file&#34; within that directory and, if present, to the   --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- corresponding resource URI for display.                              --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- If no welcome files are present, the default servlet either serves a --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- directory listing (see default servlet configuration on how to       --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- customize) or returns a 404 status, depending on the value of the    --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- listings setting.                                                    --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!--                                                                      --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- If you define welcome files in your own application&#39;s web.xml        --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- deployment descriptor, that list *replaces* the list configured      --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- here, so be sure to include any of the default values that you wish  --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- to use within your application.                                       --&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;welcome-file-list&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;welcome-file&gt;</span>index.html<span style="color:#f92672">&lt;/welcome-file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;welcome-file&gt;</span>index.htm<span style="color:#f92672">&lt;/welcome-file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;welcome-file&gt;</span>index.jsp<span style="color:#f92672">&lt;/welcome-file&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/welcome-file-list&gt;</span>
</span></span></code></pre></div><p>ç„¶åæ€ä¹ˆè¦†ç›–è¿™ä¸ªhome pageå‘¢? åˆšå¥½çœ‹åˆ°äº†ä¸‹é¢è¿™ä¸ªå›ç­”, çœ‹æ¥å’Œæˆ‘ä»¬çŒœæƒ³çš„ä¸€æ ·, å¦‚ä¸‹:</p>
<p>In any web application, there will be a <code>web.xml</code> in the <code>WEB-INF/</code> folder. (åˆ«å¿˜äº†æˆ‘ä»¬ä¹‹å‰å­¦ä¹ JSPçš„æ—¶å€™å¯æ²¡å°‘åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹èŠ±æ—¶é—´å»é…ç½®servlet nameå’Œå¯¹åº”çš„jsp, æ¯åˆ›å»ºä¸€ä¸ªæ–°çš„servletå°±è¦åœ¨è¿™åˆ›å»ºä¸ªæ–°çš„servlet pattern)</p>
<p>If you dont have one in your web app, as it seems to be the case in your folder structure, the default <strong>Tomcat</strong> <code>web.xml</code> is under <code>TOMCAT_HOME/conf/web.xml</code></p>
<p>Either way, the relevant lines of the web.xml are</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;welcome-file-list&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;welcome-file&gt;</span>index.html<span style="color:#f92672">&lt;/welcome-file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;welcome-file&gt;</span>index.htm<span style="color:#f92672">&lt;/welcome-file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;welcome-file&gt;</span>index.jsp<span style="color:#f92672">&lt;/welcome-file&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/welcome-file-list&gt;</span>
</span></span></code></pre></div><p>so any file matching this pattern when found will be shown as the home page.</p>
<p>In Tomcat, a web.xml setting within your web app will override the default, if present.</p>
<p>Further Reading: <a href="http://wiki.apache.org/tomcat/HowTo#How_do_I_override_the_default_home_page_loaded_by_Tomcat.3F">How do I override the default home page loaded by Tomcat?</a></p>
<p>å‚è€ƒ:</p>
<ul>
<li><a href="https://www.theserverside.com/video/Step-by-step-Maven-Tomcat-WAR-file-deploy-example">Step-by-step Maven Tomcat WAR file deploy example | TheServerSide</a></li>
<li><a href="https://juejin.cn/post/7133755807253921829">tomcatå¯åŠ¨æˆåŠŸæµè§ˆå™¨å´æ— æ³•è®¿é—® - æ˜é‡‘</a></li>
<li><a href="https://stackoverflow.com/a/3976385/16317008">web applications - How does Tomcat find the HOME PAGE of my Web App? - Stack Overflow</a></li>
<li><a href="https://www.baeldung.com/maven-generate-war-file">Generate a WAR File in Maven | Baeldung</a></li>
</ul>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">æŸ¥çœ‹å…¶ä»–æ–‡ç« </span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="https://blog.jiyi27.com/posts/java/backend/003-spring-embedded-tomcat/" class="button inline prev">
        Spring Boot ä¹‹ä½•ä¸ºå†…åµŒ Tomcat
      </a>
    
    
      ::
    
    
      <a href="https://blog.jiyi27.com/posts/bugs/002-bug-domain-with-two-ip/" class="button inline next">
        Cloudflare ä»£ç†æ— æ³•é€šè¿‡åŸŸåè§£æå‡º IP é—®é¢˜
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/jiyi27/jiyi27.github.io" target="_blank">Theme</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
