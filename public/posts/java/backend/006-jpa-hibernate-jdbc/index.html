<!DOCTYPE html>
<html lang="en">
<head>
  
    
    <title>JDBC, JPA, ORM Hibernate :: ä¸ºéœœçš„åšå®¢</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="1. JDBC vs MySQL Connector JDBCï¼ˆJava Database Connectivityï¼‰æ˜¯ Java è®¿é—®æ•°æ®åº“çš„æœ€åº•å±‚æ ‡å‡†è§„èŒƒå’Œ APIã€‚å®ƒæä¾›äº†è¿æ¥æ•°æ®åº“ã€æ‰§è¡Œ SQLã€è·å–ç»“æœé›†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚
åé¢æåˆ°çš„ MyBatisã€Hibernateã€Spring Data JPA éƒ½æ˜¯åŸºäº JDBC æ¥æ‰§è¡Œåº•å±‚ SQL æ“ä½œçš„ã€‚
å¯ä»¥ç›´æ¥ç¼–å†™ SQLã€ä½¿ç”¨ PreparedStatement ç­‰ API æ¥æ‰§è¡Œæ“ä½œã€‚
Sometimes, I always mistake MySQL driver for JDBC, a little funny, lol. JDBC is part of JDK, which is java&rsquo;s standard library, like code belowjava.sql.* belongs to Java SE API, which is also called JDBC API.
We often add com.mysql.cj.jdbc.Driver dependency to our maven project. Actually com.mysql.cj.jdbc.Driver is MySQL Connector.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://blog.jiyi27.com/posts/java/backend/006-jpa-hibernate-jdbc/" />





  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/categories.min.3202f75cbb294747099af3850a68a09ee94b3ce505fc39e134692d90ff0a9b2a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/code.min.dd73d157e77e82a3dc1cb06ba424cf6cc6811af0bb604ad6c68e70faf2439c8a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/main.min.3fb8954e26342ad3afabb4525959bfec6f9fc0d6929f0dda738ddeee30211690.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/menu.min.8cee75f73b9f9b1e40bd0dd53e6e770156b08bbfe1c579cd256c3f6cd3b6d32b.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/post.min.014a50745fbdd41d5f420a3e288730d5af4b7d90344dc6211d0e50c368b5b303.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/prism.min.b958d3d7c6c67361b945f9062d07d403422604b3d2cd33f93b88d41ed0ba634d.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/term.min.94de320c1b850e126e6d2c88a7c90acf58bb1313f0ea14a14cda2a42f2a88db2.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="https://blog.jiyi27.com/terminal.css">




<link rel="shortcut icon" href="https://blog.jiyi27.com/favicon.png">
<link rel="apple-touch-icon" href="https://blog.jiyi27.com/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="JDBC, JPA, ORM Hibernate">
<meta property="og:description" content="1. JDBC vs MySQL Connector JDBCï¼ˆJava Database Connectivityï¼‰æ˜¯ Java è®¿é—®æ•°æ®åº“çš„æœ€åº•å±‚æ ‡å‡†è§„èŒƒå’Œ APIã€‚å®ƒæä¾›äº†è¿æ¥æ•°æ®åº“ã€æ‰§è¡Œ SQLã€è·å–ç»“æœé›†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚
åé¢æåˆ°çš„ MyBatisã€Hibernateã€Spring Data JPA éƒ½æ˜¯åŸºäº JDBC æ¥æ‰§è¡Œåº•å±‚ SQL æ“ä½œçš„ã€‚
å¯ä»¥ç›´æ¥ç¼–å†™ SQLã€ä½¿ç”¨ PreparedStatement ç­‰ API æ¥æ‰§è¡Œæ“ä½œã€‚
Sometimes, I always mistake MySQL driver for JDBC, a little funny, lol. JDBC is part of JDK, which is java&rsquo;s standard library, like code belowjava.sql.* belongs to Java SE API, which is also called JDBC API.
We often add com.mysql.cj.jdbc.Driver dependency to our maven project. Actually com.mysql.cj.jdbc.Driver is MySQL Connector.
" />
<meta property="og:url" content="https://blog.jiyi27.com/posts/java/backend/006-jpa-hibernate-jdbc/" />
<meta property="og:site_name" content="ä¸ºéœœçš„åšå®¢" />

  <meta property="og:image" content="https://blog.jiyi27.com/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="spring boot" />


  <meta property="article:published_time" content="2025-02-06 23:15:20 &#43;0000 UTC" />












</head>
<body>


<div class="container center">

  
  
  

  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://blog.jiyi27.com/posts/java/backend/006-jpa-hibernate-jdbc/">JDBC, JPA, ORM Hibernate</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-02-06</time><span class="post-reading-time">4 åˆ†é’Ÿé˜…è¯» (775 å­—æ•°)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://blog.jiyi27.com/tags/spring-boot/">spring boot</a>&nbsp;
      
      #<a href="https://blog.jiyi27.com/tags/%E9%9D%A2%E8%AF%95/">é¢è¯•</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h2 id="1-jdbc-vs-mysql-connector">1. JDBC vs MySQL Connector<a href="#1-jdbc-vs-mysql-connector" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<blockquote>
<p>JDBCï¼ˆJava Database Connectivityï¼‰æ˜¯ Java è®¿é—®æ•°æ®åº“çš„æœ€åº•å±‚æ ‡å‡†è§„èŒƒå’Œ APIã€‚å®ƒæä¾›äº†è¿æ¥æ•°æ®åº“ã€æ‰§è¡Œ SQLã€è·å–ç»“æœé›†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<p>åé¢æåˆ°çš„ MyBatisã€Hibernateã€Spring Data JPA éƒ½æ˜¯åŸºäº JDBC æ¥æ‰§è¡Œåº•å±‚ SQL æ“ä½œçš„ã€‚</p>
<p>å¯ä»¥ç›´æ¥ç¼–å†™ SQLã€ä½¿ç”¨ <code>PreparedStatement</code> ç­‰ API æ¥æ‰§è¡Œæ“ä½œã€‚</p>
</blockquote>
<p>Sometimes, I always mistake MySQL driver for JDBC, a little funny, lol. JDBC is part of JDK, which is java&rsquo;s standard library, like code below<code>java.sql.*</code> belongs to <strong>Java SE API</strong>, which is also called JDBC API.</p>
<p>We often add <code>com.mysql.cj.jdbc.Driver</code> dependency to our maven project. Actually <code>com.mysql.cj.jdbc.Driver</code> is MySQL Connector.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> database;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// java.sql.* å±äº Java SE API, è¿™å°±æ˜¯ JDBC API</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.sql.Connection;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.sql.DriverManager;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.sql.SQLException;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MysqlDatabase</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Connection <span style="color:#a6e22e">connect</span>() <span style="color:#66d9ef">throws</span> SQLException {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// You must load jdbc driver, otherwise you will get null for connection.</span>
</span></span><span style="display:flex;"><span>        Class.<span style="color:#a6e22e">forName</span>(<span style="color:#e6db74">&#34;com.mysql.cj.jdbc.Driver&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> DriverManager.<span style="color:#a6e22e">getConnection</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">url</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">user</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">password</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="https://pub-2a6758f3b2d64ef5bb71ba1601101d35.r2.dev/blogs/2025/02/79dc888c7c722f47ead990dff67223ee.png" alt=""></p>
<p>As shown above <code>java.sql.SQLException</code> and <code>java.sql.Connection</code> are all belong to <code>java.sql.*</code> which is part of java se api, namely, JDBC. So we don&rsquo;t commucate with MySQL database with MySQL Connector directly, actually, we conmmucate with MySQL(retrive &amp; insert data) by &ldquo;talking&rdquo; to JDBC API, then JDBC API commucate with MySQL Connector, and MySQL Connector commucate with MySQL database.</p>
<h2 id="2-jpa-jakarta-persistence-api">2. JPA (Jakarta Persistence API)<a href="#2-jpa-jakarta-persistence-api" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>JPA åªæ˜¯ä¸€ä¸ªè§„èŒƒ, å®ƒå®šä¹‰äº†ä¸€å¥—æ¥å£å’Œæ³¨è§£ä½“ç³»ï¼Œæ¯”å¦‚ <code>@Entity</code>, <code>@Table</code>, <code>@Id</code>, <code>@Column</code> ç­‰ã€‚</p>
<p>JPA çš„å®ç°ï¼šè¦æƒ³è®© JPA çš„æ¥å£å’Œæ³¨è§£çœŸçš„â€œè·‘èµ·æ¥â€ï¼Œå°±éœ€è¦æœ‰ä¸€ä¸ªå…·ä½“çš„å®ç°ç±»åº“ï¼ˆproviderï¼‰</p>
<ul>
<li>Hibernate æ˜¯ JPA çš„ä¸€ä¸ªå®ç°ã€‚å®ƒè´Ÿè´£è§£æ JPA çš„æ³¨è§£ï¼Œå¹¶æ‰§è¡Œå…·ä½“çš„ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰é€»è¾‘ï¼Œæ¯”å¦‚ç”Ÿæˆ SQL è¯­å¥ï¼Œç®¡ç†æ•°æ®åº“æ“ä½œç­‰ã€‚<strong>JPA åªæ˜¯å®šä¹‰è§„åˆ™ï¼Œè€Œ Hibernate è´Ÿè´£æ‰§è¡Œã€‚</strong> å¦‚æœæ²¡æœ‰ JPA çš„å®ç°ï¼Œ<code>@Entity</code> ç­‰æ³¨è§£å°±æ²¡æœ‰æ„ä¹‰</li>
<li>OpenJPAï¼ˆApache çš„å®ç°ï¼‰</li>
</ul>
<p><strong>Spring Data JPA</strong> æ˜¯ <strong>åŸºäº JPA è§„èŒƒ</strong> çš„ä¸€ä¸ª Spring ç”Ÿæ€ç»„ä»¶ï¼Œå®ƒç®€åŒ–äº† JPA çš„ä½¿ç”¨ï¼Œæ¯”å¦‚æä¾›äº† <code>JpaRepository</code> è®©ä½ ä¸ç”¨æ‰‹å†™ SQL æŸ¥è¯¢ã€‚Spring Data JPA ä»ç„¶éœ€è¦ JPA Providerï¼ˆæ¯”å¦‚ Hibernateï¼‰ æ¥æ‰§è¡Œå®é™…çš„æ•°æ®åº“æ“ä½œã€‚Spring Data JPA æœ¬èº«ä¸æ˜¯ ORM æ¡†æ¶ï¼Œå®ƒåªæ˜¯å¯¹ JPA è¿›è¡Œäº†å°è£…ï¼Œä½¿å¾— JPA çš„ä½¿ç”¨æ›´æ–¹ä¾¿ã€‚</p>
<blockquote>
<p>MyBatis æ˜¯ä¸€æ¬¾åŠ ORM / æ•°æ®æ˜ å°„ï¼ˆData Mapperï¼‰æ¡†æ¶ï¼Œä¸ä¼ ç»Ÿçš„ JDBC ç›¸æ¯”æ›´çµæ´»ä¸”ç®€åŒ–äº†æ•°æ®è®¿é—®çš„è¿‡ç¨‹ï¼Œä½†ä¸åƒ Hibernate é‚£æ ·åšå…¨é‡çš„å®ä½“ä¸è¡¨çš„è‡ªåŠ¨æ˜ å°„</p>
<p><strong>MyBatis ä¸æ˜¯ JPA å®ç°</strong>ï¼Œè€Œæ˜¯å¦ä¸€ç§ç‹¬ç«‹çš„ ORM æ–¹æ¡ˆï¼Œä¸èƒ½ç”¨æ¥æ›¿ä»£ Hibernateï¼Œä½†å¯ä»¥åœ¨é¡¹ç›®ä¸­å’Œ JPA å…±åŒä½¿ç”¨ï¼ˆæ¯”å¦‚å¤æ‚æŸ¥è¯¢ç”¨ MyBatisï¼Œç®€å•å¢åˆ æ”¹æŸ¥ç”¨ JPAï¼‰</p>
</blockquote>
<h2 id="3-spring-data-jpa--jpa--hibernate-å„å¸å…¶èŒ">3. Spring Data JPA + JPA + Hibernate å„å¸å…¶èŒ<a href="#3-spring-data-jpa--jpa--hibernate-å„å¸å…¶èŒ" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<h3 id="31-jpamodel-å±‚">3.1. JPAï¼ˆModel å±‚ï¼‰<a href="#31-jpamodel-å±‚" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> jakarta.persistence.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Entity</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Table</span>(name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;users&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Id</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@GeneratedValue</span>(strategy <span style="color:#f92672">=</span> GenerationType.<span style="color:#a6e22e">IDENTITY</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Long id;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// nullable = false åœ¨ Java å±‚é¢é˜²æ­¢é”™è¯¯æ•°æ®è¿›å…¥æ•°æ®åº“ï¼Œå³ä½¿æ•°æ®åº“å±‚é¢æœ‰ NOT NULL çº¦æŸ</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Column</span>(nullable <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>, unique <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>, length <span style="color:#f92672">=</span> 50)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String username;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<ul>
<li><code>@Entity</code>ï¼šæ ‡æ˜è¯¥ç±»æ˜¯ JPA å®ä½“</li>
<li><code>@Table(name = &quot;users&quot;)</code>ï¼šæŒ‡å®šæ•°æ®åº“è¡¨å</li>
<li><code>@Id</code>ã€<code>@GeneratedValue</code>ï¼šå®šä¹‰ä¸»é”®åŠå…¶ç”Ÿæˆç­–ç•¥</li>
<li><code>@Column</code>ï¼šæŒ‡å®šå­—æ®µçº¦æŸ</li>
</ul>
<p>è¿™é‡Œ <code>@Entity</code> å’Œ <code>@Table</code> ç­‰æ˜¯ JPA è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬åªæ˜¯ <strong>å‘Šè¯‰ JPA Providerï¼ˆæ¯”å¦‚ Hibernateï¼‰</strong>ï¼Œè¿™ä¸ªç±»éœ€è¦æ˜ å°„åˆ°æ•°æ®åº“è¡¨ã€‚ä½†çœŸæ­£è§£æè¿™äº›æ³¨è§£å¹¶ç”Ÿæˆ SQL è¯­å¥çš„æ˜¯ Hibernateã€‚ä½ å†™çš„æ˜¯ JPA ä»£ç ï¼Œä½†å®é™… SQL æ˜¯ Hibernate ç”Ÿæˆçš„, <strong>JPA åªå®šä¹‰è§„åˆ™ï¼ŒHibernate è´Ÿè´£æ‰§è¡Œ</strong></p>
</blockquote>
<h3 id="32-spring-data-jparepository-å±‚">3.2. Spring Data JPAï¼ˆRepository å±‚ï¼‰<a href="#32-spring-data-jparepository-å±‚" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Spring Data JPA è®©æˆ‘ä»¬å¯ä»¥ä¸å†™ SQL ä¹Ÿèƒ½æ“ä½œæ•°æ®åº“ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.springframework.data.jpa.repository.JpaRepository;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.springframework.data.jpa.repository.Query;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.springframework.data.repository.query.Param;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.springframework.stereotype.Repository;
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Repository</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">PostRepository</span> <span style="color:#66d9ef">extends</span> JpaRepository<span style="color:#f92672">&lt;</span>Post, Long<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æŸ¥æ‰¾ç”¨æˆ·çš„æ‰€æœ‰å¸–å­</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Query</span>(<span style="color:#e6db74">&#34;SELECT p FROM Post p WHERE p.userId = :userId AND p.status = 1&#34;</span>)
</span></span><span style="display:flex;"><span>    Page<span style="color:#f92672">&lt;</span>Post<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findByUserId</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;userId&#34;</span>) Long userId, Pageable pageable);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æŸ¥æ‰¾æ‰€æœ‰æ­£å¸¸çŠ¶æ€çš„å¸–å­ï¼ˆåˆ†é¡µï¼‰</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Query</span>(<span style="color:#e6db74">&#34;SELECT p FROM Post p WHERE p.status = 1&#34;</span>)
</span></span><span style="display:flex;"><span>    Page<span style="color:#f92672">&lt;</span>Post<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findAllActivePosts</span>(Pageable pageable);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p><code>@Query</code>ã€<code>@Param</code>ã€<code>JpaRepository</code>ã€<code>Pageable</code> ç­‰æ³¨è§£å’Œæ¥å£éƒ½æ˜¯ Spring Data JPA æä¾›çš„ï¼Œè€Œä¸æ˜¯ æ ‡å‡† JPAï¼ˆJakarta Persistence APIï¼‰ æˆ– Hibernate æœ¬èº«çš„ä¸€éƒ¨åˆ†</p>
<p>è¿™äº›æ–¹æ³• <strong>ä¸éœ€è¦æ‰‹åŠ¨å®ç°</strong>ï¼Œ<strong>Spring Data JPA</strong> ä¼š<strong>è‡ªåŠ¨</strong>ç”Ÿæˆå¯¹åº”çš„ SQL è¯­å¥å¹¶æ‰§è¡Œï¼Œä½ åªéœ€è¦å£°æ˜æ–¹æ³•å³å¯ç›´æ¥è°ƒç”¨</p>
</blockquote>
<p><code>@Query</code> å¯ä»¥ä¼˜åŒ–æ‰ï¼Œè®© Spring Data JPA è‡ªåŠ¨ç”Ÿæˆ SQL è¯­å¥, Spring Data JPA ä¼š <strong>è‡ªåŠ¨è§£ææ–¹æ³•å</strong> ç”Ÿæˆ SQL æŸ¥è¯¢, ä¸Šé¢ä»£ç å¯ä»¥æ”¹æˆ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Repository</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">PostRepository</span> <span style="color:#66d9ef">extends</span> JpaRepository<span style="color:#f92672">&lt;</span>Post, Long<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æŸ¥æ‰¾ç”¨æˆ·çš„æ‰€æœ‰æ­£å¸¸çŠ¶æ€å¸–å­</span>
</span></span><span style="display:flex;"><span>    Page<span style="color:#f92672">&lt;</span>Post<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findByUserIdAndStatus</span>(Long userId, <span style="color:#66d9ef">int</span> status, Pageable pageable);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æŸ¥æ‰¾æ‰€æœ‰æ­£å¸¸çŠ¶æ€çš„å¸–å­</span>
</span></span><span style="display:flex;"><span>    Page<span style="color:#f92672">&lt;</span>Post<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findByStatus</span>(<span style="color:#66d9ef">int</span> status, Pageable pageable);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚æœæŸ¥è¯¢é€»è¾‘ å¤æ‚ï¼ŒSpring Data JPA æ— æ³•è‡ªåŠ¨æ¨æ–­ï¼Œå°±éœ€è¦ <code>@Query</code>ï¼Œæ¯”å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Query</span>(<span style="color:#e6db74">&#34;SELECT p FROM Post p WHERE p.userId = :userId AND p.status = 1 ORDER BY p.createdAt DESC&#34;</span>)
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Post<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findRecentPostsByUser</span>(<span style="color:#a6e22e">@Param</span>(<span style="color:#e6db74">&#34;userId&#34;</span>) Long userId);
</span></span></code></pre></div><h3 id="33-hibernateæŒä¹…åŒ–å±‚">3.3. <strong>Hibernateï¼ˆæŒä¹…åŒ–å±‚ï¼‰</strong><a href="#33-hibernateæŒä¹…åŒ–å±‚" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Hibernate ä½œä¸º JPA Providerï¼Œåœ¨åå°å®é™…æ‰§è¡Œ SQL è¯­å¥, å½“æˆ‘ä»¬è°ƒç”¨ <code>userRepository.findByEmail(&quot;test@example.com&quot;)</code> æ—¶ï¼ŒHibernate ä¼šç”Ÿæˆ SQL æŸ¥è¯¢ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>SELECT <span style="color:#f92672">*</span> FROM users WHERE email <span style="color:#f92672">=</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>test<span style="color:#a6e22e">@example.com</span><span style="color:#960050;background-color:#1e0010">&#39;</span> LIMIT 1;
</span></span></code></pre></div><h2 id="4-spring-data-jpa--jpa--hibernate">4. Spring Data JPA + JPA + Hibernate<a href="#4-spring-data-jpa--jpa--hibernate" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.springframework.data.jpa.repository.JpaRepository;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.Optional;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserRepository</span> <span style="color:#66d9ef">extends</span> JpaRepository<span style="color:#f92672">&lt;</span>User, Long<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    Optional<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findByEmail</span>(String email);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¿™é‡Œ <code>findByEmail(String email)</code> æ–¹æ³•æ²¡æœ‰å®ç°ï¼Œä¸ºä»€ä¹ˆå®ƒè¿˜èƒ½æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢å‘¢ï¼Ÿè¿™æ˜¯ <strong>Spring Data JPA + JPA + Hibernate</strong> ä¸‰è€…åä½œçš„ç»“æœ, å½“ä½ è°ƒç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Optional<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> user <span style="color:#f92672">=</span> userRepository.<span style="color:#a6e22e">findByEmail</span>(<span style="color:#e6db74">&#34;test@example.com&#34;</span>);
</span></span></code></pre></div><p>Spring Data JPAã€JPAï¼ˆEntityManagerï¼‰å’Œ Hibernate ä¼šåˆ†åˆ«æ‰§è¡Œè‡ªå·±çš„å·¥ä½œï¼š</p>
<p><strong>1ï¸âƒ£ Spring Data JPAï¼ˆæä¾› Repository ä»£ç†ï¼‰</strong></p>
<p>Spring Data JPA çœ‹åˆ° <code>UserRepository</code> ç»§æ‰¿äº† <code>JpaRepository</code>ï¼Œå°±ä¼šï¼š</p>
<ul>
<li>è‡ªåŠ¨ç”Ÿæˆ <code>findByEmail</code> æ–¹æ³•çš„å®ç°</li>
<li>è°ƒç”¨ JPA çš„ <code>EntityManager</code> API è¿›è¡ŒæŸ¥è¯¢</li>
</ul>
<p>ğŸ“Œ è¿™é‡Œçš„å…³é”®ç‚¹ï¼š</p>
<ul>
<li>ä½ æ²¡æœ‰æ‰‹å†™ SQLï¼Œä½† Spring Data JPA æ ¹æ®æ–¹æ³•å è§£æå‡ºæŸ¥è¯¢æ„å›¾</li>
<li>å®ƒä¼šè°ƒç”¨ JPAï¼ˆEntityManagerï¼‰ æ¥æ‰§è¡ŒæŸ¥è¯¢</li>
</ul>
<p><strong>2ï¸âƒ£ JPAï¼ˆEntityManager æä¾›æŸ¥è¯¢ APIï¼‰</strong></p>
<p>Spring Data JPA å†…éƒ¨ä¼šä½¿ç”¨ JPA çš„ <code>EntityManager</code> æ‰§è¡ŒæŸ¥è¯¢ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>entityManager.<span style="color:#a6e22e">createQuery</span>(<span style="color:#e6db74">&#34;SELECT u FROM User u WHERE u.email = :email&#34;</span>, User.<span style="color:#a6e22e">class</span>);
</span></span></code></pre></div><p>ğŸ“Œ JPAï¼ˆEntityManagerï¼‰åœ¨è¿™é‡Œçš„è§’è‰²ï¼š</p>
<ul>
<li>æä¾› API è®© Spring Data JPA è°ƒç”¨ï¼ˆæ¯”å¦‚ <code>createQuery()</code>ï¼‰</li>
<li>ä¸ä¼šè§£æå’Œæ‰§è¡Œ SQLï¼Œå®ƒåªæ˜¯ JPA æ ‡å‡†çš„å®ç°è€…</li>
</ul>
<p><strong>3ï¸âƒ£ Hibernateï¼ˆJPA Provider è§£æ &amp; æ‰§è¡Œ SQLï¼‰</strong></p>
<p>Hibernate ä½œä¸º JPA Providerï¼Œæ¥æ‰‹ <code>EntityManager</code> æä¾›çš„æŸ¥è¯¢è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œ SQLï¼š</p>
<ul>
<li>
<p>è§£æ JPQLï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> u <span style="color:#66d9ef">FROM</span> <span style="color:#66d9ef">User</span> u <span style="color:#66d9ef">WHERE</span> u.email <span style="color:#f92672">=</span> :email
</span></span></code></pre></div></li>
<li>
<p>è½¬æ¢æˆåŸç”Ÿ SQLï¼ˆé’ˆå¯¹ MySQLã€PostgreSQL ç­‰æ•°æ®åº“ç”Ÿæˆ SQLï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> users <span style="color:#66d9ef">WHERE</span> email <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;test@example.com&#39;</span> <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>;
</span></span></code></pre></div></li>
<li>
<p>æ‰§è¡Œ SQLï¼Œä»æ•°æ®åº“æŸ¥è¯¢ç»“æœï¼Œå¹¶è¿”å› <code>User</code> å®ä¾‹ã€‚</p>
</li>
</ul>
<p>ğŸ“Œ Hibernate è´Ÿè´£çš„éƒ¨åˆ†ï¼š</p>
<ul>
<li>è§£æ JPA çš„æŸ¥è¯¢è¯­æ³•ï¼ˆJPQLï¼‰</li>
<li>ç”Ÿæˆ SQL å¹¶æ‰§è¡Œ</li>
<li>æŠŠæ•°æ®åº“æŸ¥è¯¢ç»“æœè½¬æ¢æˆ Java å¯¹è±¡</li>
</ul>
<p><strong>å®Œæ•´æµç¨‹æ€»ç»“</strong></p>
<table>
  <thead>
      <tr>
          <th><strong>æ­¥éª¤</strong></th>
          <th><strong>æ‰§è¡Œè€…</strong></th>
          <th><strong>ä½œç”¨</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>1</strong></td>
          <td><strong>Spring Data JPA</strong></td>
          <td>è§£æ <code>findByEmail</code> æ–¹æ³•ï¼Œè°ƒç”¨ <code>EntityManager</code></td>
      </tr>
      <tr>
          <td><strong>2</strong></td>
          <td><strong>JPAï¼ˆEntityManagerï¼‰</strong></td>
          <td>è´Ÿè´£ API è°ƒç”¨ï¼Œå‡†å¤‡ JPQL æŸ¥è¯¢</td>
      </tr>
      <tr>
          <td><strong>3</strong></td>
          <td><strong>Hibernate</strong></td>
          <td>è§£æ JPQLï¼Œè½¬æ¢ä¸º SQLï¼Œå¹¶æ‰§è¡ŒæŸ¥è¯¢</td>
      </tr>
      <tr>
          <td><strong>4</strong></td>
          <td><strong>æ•°æ®åº“</strong></td>
          <td>è¿è¡Œ SQLï¼Œè¿”å›æ•°æ®</td>
      </tr>
      <tr>
          <td><strong>5</strong></td>
          <td><strong>Hibernate</strong></td>
          <td>è§£æ SQL ç»“æœï¼Œè½¬æ¢æˆ <code>User</code> å¯¹è±¡</td>
      </tr>
      <tr>
          <td><strong>6</strong></td>
          <td><strong>Spring Data JPA</strong></td>
          <td>è¿”å› <code>User</code> å¯¹è±¡ç»™è°ƒç”¨è€…</td>
      </tr>
  </tbody>
</table>
<p><strong>æ€»ç»“</strong></p>
<ul>
<li>Spring Data JPA è®©ä½ ä¸ç”¨æ‰‹å†™ SQLï¼Œç›´æ¥è°ƒç”¨ <code>JpaRepository</code> æ–¹æ³•</li>
<li>JPAï¼ˆEntityManagerï¼‰ åªæ˜¯æä¾› APIï¼Œä¸ä¼šæ‰§è¡Œ SQL</li>
<li>Hibernate ä½œä¸º JPA Providerï¼Œè´Ÿè´£æ‰§è¡Œ SQLï¼Œå¹¶è½¬æ¢ç»“æœ</li>
</ul>
<p>ğŸ’¡ <strong>æœ€ç»ˆçš„ SQL æŸ¥è¯¢æ˜¯ Hibernate è´Ÿè´£æ‰§è¡Œçš„</strong>ï¼ŒSpring Data JPA å’Œ JPA åªæ˜¯æä¾› API å’Œæ¥å£ï¼ŒçœŸæ­£çš„æ•°æ®åº“æ“ä½œå…¨é  Hibernateã€‚</p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">æŸ¥çœ‹å…¶ä»–æ–‡ç« </span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="https://blog.jiyi27.com/posts/interview/%E7%AE%97%E6%B3%95/003-link-algorithm/" class="button inline prev">
        ç®—æ³•é¢˜ é“¾è¡¨ç³»åˆ—
      </a>
    
    
      ::
    
    
      <a href="https://blog.jiyi27.com/posts/java/basics/003-jvm-memory/" class="button inline next">
        JVM å†…å­˜ç»“æ„ ä¸¤ç§åˆ†ç±»æ–¹å¼
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/jiyi27/jiyi27.github.io" target="_blank">Theme</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
