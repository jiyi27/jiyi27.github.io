<!DOCTYPE html>
<html lang="en">
<head>
  
    
    <title>Swift Basic Syntax and Data types :: 为霜的博客</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="1. Implicit returns SE-0255 This is a feature in Swift (SE-0255) that, for the sake of syntactic conciseness, allows the return keyword to be omitted when a method, computed property, or closure contains only a single expression.
// function or methods // for: external parameter name or call it &#39;parameter label&#39; func greeting(for person: String) -&gt; String { &#34;Hello, &#34; &#43; person &#43; &#34;!&#34; } print(greeting(for: &#34;Dave&#34;)) // Prints &#34;Hello, Dave!&#34; // computed property struct Circle { var radius: Double var circumference: Double { 2 * .pi * radius } } // closures before let square: (Int) -&gt; Int = { (number: Int) in return number * number } // closures now, no returns let square: (Int) -&gt; Int = { number in number * number } 2. Closure 2.1. Closure Syntax { (&lt;#parameters#&gt;) -&gt; &lt;#return type#&gt; in &lt;#statements#&gt; } let coo = {() -&gt; Void in print(&#34;closure&#34;) } // 因为 coo 无返回值也无参数, 可以简写为如下: let coo = { print(&#34;closure&#34;) } // 带参数以及返回值的闭包 let foo = { (str:String) -&gt; String in return str } coo() print(foo(&#34;closure&#34;)) 2.2 Trailing Closure If the last parameter to a function is a closure, Swift lets you use special syntax called trailing closure syntax. Rather than pass in your closure as a parameter, you pass it directly after the function inside braces.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://blog.jiyi27.com/posts/ios/swift/001-syntax-basics/" />





  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/categories.min.3202f75cbb294747099af3850a68a09ee94b3ce505fc39e134692d90ff0a9b2a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/code.min.dd73d157e77e82a3dc1cb06ba424cf6cc6811af0bb604ad6c68e70faf2439c8a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/main.min.3fb8954e26342ad3afabb4525959bfec6f9fc0d6929f0dda738ddeee30211690.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/menu.min.8cee75f73b9f9b1e40bd0dd53e6e770156b08bbfe1c579cd256c3f6cd3b6d32b.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/post.min.014a50745fbdd41d5f420a3e288730d5af4b7d90344dc6211d0e50c368b5b303.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/prism.min.b958d3d7c6c67361b945f9062d07d403422604b3d2cd33f93b88d41ed0ba634d.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/term.min.94de320c1b850e126e6d2c88a7c90acf58bb1313f0ea14a14cda2a42f2a88db2.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="https://blog.jiyi27.com/terminal.css">




<link rel="shortcut icon" href="https://blog.jiyi27.com/favicon.png">
<link rel="apple-touch-icon" href="https://blog.jiyi27.com/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Swift Basic Syntax and Data types">
<meta property="og:description" content="1. Implicit returns SE-0255 This is a feature in Swift (SE-0255) that, for the sake of syntactic conciseness, allows the return keyword to be omitted when a method, computed property, or closure contains only a single expression.
// function or methods // for: external parameter name or call it &#39;parameter label&#39; func greeting(for person: String) -&gt; String { &#34;Hello, &#34; &#43; person &#43; &#34;!&#34; } print(greeting(for: &#34;Dave&#34;)) // Prints &#34;Hello, Dave!&#34; // computed property struct Circle { var radius: Double var circumference: Double { 2 * .pi * radius } } // closures before let square: (Int) -&gt; Int = { (number: Int) in return number * number } // closures now, no returns let square: (Int) -&gt; Int = { number in number * number } 2. Closure 2.1. Closure Syntax { (&lt;#parameters#&gt;) -&gt; &lt;#return type#&gt; in &lt;#statements#&gt; } let coo = {() -&gt; Void in print(&#34;closure&#34;) } // 因为 coo 无返回值也无参数, 可以简写为如下: let coo = { print(&#34;closure&#34;) } // 带参数以及返回值的闭包 let foo = { (str:String) -&gt; String in return str } coo() print(foo(&#34;closure&#34;)) 2.2 Trailing Closure If the last parameter to a function is a closure, Swift lets you use special syntax called trailing closure syntax. Rather than pass in your closure as a parameter, you pass it directly after the function inside braces.
" />
<meta property="og:url" content="https://blog.jiyi27.com/posts/ios/swift/001-syntax-basics/" />
<meta property="og:site_name" content="为霜的博客" />

  <meta property="og:image" content="https://blog.jiyi27.com/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="ios" />


  <meta property="article:published_time" content="2024-05-15 22:03:35 &#43;0000 UTC" />












</head>
<body>


<div class="container center">

  
  
  

  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://blog.jiyi27.com/posts/ios/swift/001-syntax-basics/">Swift Basic Syntax and Data types</a>
  </h1>
  <div class="post-meta"><time class="post-date">2024-05-15</time><span class="post-reading-time">6 分钟阅读 (1276 字数)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://blog.jiyi27.com/tags/ios/">ios</a>&nbsp;
      
      #<a href="https://blog.jiyi27.com/tags/swift/">swift</a>&nbsp;
      
      #<a href="https://blog.jiyi27.com/tags/%E9%97%AD%E5%8C%85/">闭包</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h1 id="1-implicit-returns-se-0255">1. Implicit returns SE-0255<a href="#1-implicit-returns-se-0255" class="hanchor" ariaLabel="Anchor">#</a> </h1>
<p>This is a feature in Swift (SE-0255) that, for the sake of syntactic conciseness, allows the <code>return</code> keyword to be omitted when a method, computed property, or closure contains only a single expression.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#75715e">// function or methods</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// for: external parameter name or call it &#39;parameter label&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">greeting</span>(<span style="color:#66d9ef">for</span> person: String) -&gt; String {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Hello, &#34;</span> <span style="color:#f92672">+</span> person <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;!&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>print(greeting(<span style="color:#66d9ef">for</span>: <span style="color:#e6db74">&#34;Dave&#34;</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Prints &#34;Hello, Dave!&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#75715e">// computed property</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Circle</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> radius: Double
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> circumference: Double {
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> .pi <span style="color:#f92672">*</span> radius
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#75715e">// closures before</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> square: (Int) -&gt; Int = { (number: Int) <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> number <span style="color:#f92672">*</span> number
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// closures now, no returns</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> square: (Int) -&gt; Int = { number <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>    number <span style="color:#f92672">*</span> number
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="2-closure">2. Closure<a href="#2-closure" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<h3 id="21-closure-syntax">2.1. Closure Syntax<a href="#21-closure-syntax" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>{ (<span style="color:#f92672">&lt;</span>#parameters#<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#f92672">&lt;</span>#<span style="color:#66d9ef">return</span> type#<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;</span>#statements#<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> coo = {() -&gt; Void <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>     print(<span style="color:#e6db74">&#34;closure&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 因为 coo 无返回值也无参数, 可以简写为如下:</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> coo = {
</span></span><span style="display:flex;"><span>     print(<span style="color:#e6db74">&#34;closure&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 带参数以及返回值的闭包</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> foo = { (str:String) -&gt; String <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> str
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>coo()
</span></span><span style="display:flex;"><span>print(foo(<span style="color:#e6db74">&#34;closure&#34;</span>))
</span></span></code></pre></div><h3 id="22-trailing-closure">2.2 Trailing Closure<a href="#22-trailing-closure" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>If the last parameter to a function is a closure, Swift lets you use special syntax called <em>trailing closure syntax</em>. Rather than pass in your closure as a parameter, you pass it directly after the function inside braces.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">travel</span>(action: () -&gt; Void) {
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;I&#39;m getting ready to go.&#34;</span>)
</span></span><span style="display:flex;"><span>    action()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;I arrived!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Because its last parameter is a closure, we can call <code>travel()</code> using trailing closure syntax like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>travel() {
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;I&#39;m driving in my car&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In fact, because there aren’t any other parameters, we can eliminate the parentheses entirely:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>travel {
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;I&#39;m driving in my car&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>疑问: 参数 <code>action</code> 的类型是 <code>() -&gt; Void</code>, 而 <code>print()</code> 接受了一个参数, 他们明明不是同一个类型, 为什么把 <code>print(&quot;I'm driving in my car&quot;)</code> 当参数传给了 <code>action</code> 呢?</p>
<p>解答: 当你调用 <code>travel</code> 并传递 <code>print(&quot;I'm driving in my car&quot;)</code> 时(如下)：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>travel {
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;I&#39;m driving in my car&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>你传递的是一个闭包。这个闭包的定义如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;I&#39;m driving in my car&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>这个闭包本身符合 <code>() -&gt; Void</code> 类型，因为它不接受任何参数并且不返回任何值. 虽然闭包单个语句会自动加上 return, 但是 print 返回为空, 在此合法.</p>
<p>References: <a href="https://www.hackingwithswift.com/sixty/6/5/trailing-closure-syntax">Trailing closure syntax - a free Hacking with Swift tutorial</a></p>
<h3 id="23-call-function-without-parentheses">2.3. Call function without parentheses<a href="#23-call-function-without-parentheses" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Only when you call a function with trailing closure, you can call it without parenthese.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">getName</span>(action: () -&gt; Void) -&gt; String {
</span></span><span style="display:flex;"><span>    action()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Jack&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// call function getName, and pass a closure which contains two expressions</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> a = getName {
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;hello...&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Getting your name...&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(a)
</span></span></code></pre></div><blockquote>
<p>对于上面的代码, 因为闭包参数和返回值皆为空, 我们省略了一些东西, 完整的写法应该如下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> a = getName {() -&gt; Void <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;hello...&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Getting your name...&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>如果你需要更完整的写法, 即不使用尾随闭包, 写法应该如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> a = getName(action: { () -&gt; Void <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;hello...&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Getting your name...&#34;</span>)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div></blockquote>
<p>Assume <code>getName</code> doesn&rsquo;t have parameters, you cannot omit the parentheses when call it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">getName</span>() -&gt; String {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Jack&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> a = getName <span style="color:#75715e">// This is not calling getName, this is assign a function to variable &#39;a&#39;</span>
</span></span></code></pre></div><h3 id="24-trailing-closure-in-swiftui">2.4. Trailing Closure in SwiftUI<a href="#24-trailing-closure-in-swiftui" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>VStack 的简单定义:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">VStack</span>&lt;Content: View&gt;: View {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 最后一个参数是闭包, 因此构建 VStack 可以使用 尾随闭包语法</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">init</span>(@ViewBuilder content: () -&gt; Content)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> body: some View {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 内部实现</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>实际使用</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> body: some View { 
</span></span><span style="display:flex;"><span>    VStack { <span style="color:#75715e">// 这里使用了尾随闭包, 因为这里没有给VStack构造函数传递其他参数, 因此调用时可省略括号()</span>
</span></span><span style="display:flex;"><span>        Text(<span style="color:#e6db74">&#34;Hello World&#34;</span>)
</span></span><span style="display:flex;"><span>        Text(<span style="color:#e6db74">&#34;Title&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 不使用尾随闭包</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> body: some View {
</span></span><span style="display:flex;"><span>    VStack(content:{
</span></span><span style="display:flex;"><span>        Text(<span style="color:#e6db74">&#34;Hello World&#34;</span>)
</span></span><span style="display:flex;"><span>        Text(<span style="color:#e6db74">&#34;Title&#34;</span>)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>@ViewBuilder</code> 允许你在一个闭包中返回多个视图，并且会自动将这些视图组合成一个视图。比如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>VStack {
</span></span><span style="display:flex;"><span>    Text(<span style="color:#e6db74">&#34;Hello, world!&#34;</span>)
</span></span><span style="display:flex;"><span>    Text(<span style="color:#e6db74">&#34;Hello World&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>在这里，<code>VStack</code> 的闭包传递给了 <code>content</code> 参数。这个闭包内部包含了两个 <code>Text</code> 视图。<code>@ViewBuilder</code> 属性包装器会处理这个闭包，将其转换为单一的视图内容。</p>
<p><strong>具体工作机制</strong></p>
<ol>
<li><strong>闭包定义</strong>：你在 <code>VStack</code> 中传递了一个闭包，这个闭包包含多个视图。</li>
<li><strong><code>@ViewBuilder</code> 处理</strong>：<code>@ViewBuilder</code> 会将闭包中的多个视图组合成一个视图。它会将这些视图收集起来，构建一个包含所有子视图的视图树。</li>
<li><strong>传递组合视图</strong>：最终，这个组合视图被传递给 <code>VStack</code>，作为其内容。</li>
</ol>
<p>因此，尽管看起来你传递了多个视图（比如 <code>Text(&quot;Hello, world!&quot;)</code> 和 <code>Text(&quot;Hello World&quot;)</code>），但实际上你传递的是一个闭包，这个闭包在 <code>@ViewBuilder</code> 的帮助下返回了一个组合视图。</p>
<blockquote>
<p><code>@ViewBuilder</code> 实际上是 Swift 中的一种 Result Builder, 后面会讲.</p>
</blockquote>
<p>综上:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">ContentView</span>: View {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 计算属性 省略 return</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> body: some View {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Trailing Closure 和 Result Builder 特性</span>
</span></span><span style="display:flex;"><span>        VStack {
</span></span><span style="display:flex;"><span>            Text(<span style="color:#e6db74">&#34;Hello World&#34;</span>)
</span></span><span style="display:flex;"><span>            Text(<span style="color:#e6db74">&#34;Title&#34;</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>References: <a href="https://juejin.cn/post/6897910455138779144">(一) SwiftUI - 声明式语法分析 - 掘金</a></p>
<h3 id="25-trailing-closure-in-swiftui">2.5. Trailing Closure in SwiftUI<a href="#25-trailing-closure-in-swiftui" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">addItem</span>() {
</span></span><span style="display:flex;"><span>    withAnimation {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> newItem = Item(context: viewContext)
</span></span><span style="display:flex;"><span>        newItem.timestamp = Date()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> viewContext.save()
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">let</span> nsError = error <span style="color:#66d9ef">as</span> NSError
</span></span><span style="display:flex;"><span>            fatalError(<span style="color:#e6db74">&#34;Unresolved error </span><span style="color:#e6db74">\(</span>nsError<span style="color:#e6db74">)</span><span style="color:#e6db74">, </span><span style="color:#e6db74">\(</span>nsError.userInfo<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>withAnimation</code> 是个函数,  最后一个参数是个闭包, 因此调用 withAnimation 时可以直接将参数闭包放于函数体内, 从而省略了圆括号, 这个语法上面讲了,  另外这里传递闭包的时候我们还省略的闭包的返回值, 因为当返回值为 Void, 原本的写法应该是这样:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>withAnimation { () -&gt; Void <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 闭包体</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>我们省略了闭包的返回值类型, 即如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>withAnimation {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 闭包体</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>withAnimation 定义如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">withAnimation</span>&lt;Result&gt;(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">_</span> animation: Animation? = .<span style="color:#66d9ef">default</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">_</span> body: () <span style="color:#66d9ef">throws</span> -&gt; Result
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">rethrows</span> -&gt; Result
</span></span></code></pre></div><p>可以看出withAnimation 有一个返回值, 切参数闭包 body 也有返回值, 但是上面我们调用  withAnimation 时却忽略了闭包的返回值, 这是因为 <code>&lt;Result&gt;</code> 可以为任何类型, 所以也可以为 Viod, 这是泛型的用法.</p>
<h2 id="3-functions">3. Functions<a href="#3-functions" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<h3 id="31-variadic-parameters">3.1. Variadic Parameters<a href="#31-variadic-parameters" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>A <em>variadic parameter</em> accepts zero or more values of a specified type.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">total</span>(<span style="color:#66d9ef">_</span> numbers: Double...) -&gt; Double {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> total: Double = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> number <span style="color:#66d9ef">in</span> numbers {
</span></span><span style="display:flex;"><span>        total <span style="color:#f92672">+=</span> number
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> total
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>total(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>) <span style="color:#75715e">// 6</span>
</span></span></code></pre></div><h3 id="32-in-out-parameters">3.2. In-Out Parameters<a href="#32-in-out-parameters" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Function parameters are constants by default. Trying to change the value of a function parameter from within the body of that function results in a compile-time error.</p>
<p>If you want a function to modify a parameter’s value, and you want those changes to persist after the function call has ended, define that parameter as an <em>in-out parameter</em> instead.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">swapTwoInts</span>(<span style="color:#66d9ef">_</span> a: <span style="color:#66d9ef">inout</span> Int, <span style="color:#66d9ef">_</span> b: <span style="color:#66d9ef">inout</span> Int) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> temporaryA = a
</span></span><span style="display:flex;"><span>    a = b
</span></span><span style="display:flex;"><span>    b = temporaryA
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> someInt = <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> anotherInt = <span style="color:#ae81ff">107</span>
</span></span><span style="display:flex;"><span>swapTwoInts(&amp;someInt, &amp;anotherInt)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;someInt is now </span><span style="color:#e6db74">\(</span>someInt<span style="color:#e6db74">)</span><span style="color:#e6db74">, and anotherInt is now </span><span style="color:#e6db74">\(</span>anotherInt<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Prints &#34;someInt is now 107, and anotherInt is now 3&#34;</span>
</span></span></code></pre></div><h2 id="4-opaque-type">4. Opaque type<a href="#4-opaque-type" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>A function or method that returns an opaque type <strong>hides</strong> its return value’s <strong>type information</strong>. Instead of providing a concrete type as the function’s return type, the return value is described in terms of the protocols it supports.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protocol</span> <span style="color:#a6e22e">Animal</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">makeSound</span>() -&gt; String
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Dog</span>: Animal {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">makeSound</span>() -&gt; String {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Woof&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Cat</span>: Animal {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">makeSound</span>() -&gt; String {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Meow&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Although we know that it returns either a Cat or a Dog, the exact type is hidden.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">getAnimal</span>() -&gt; some Animal {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Dog()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> myCar: some Vehicle = Car()
</span></span><span style="display:flex;"><span>myCar = Car() <span style="color:#75715e">// 🔴 Compile error: Cannot assign value of type &#39;Car&#39; to type &#39;some Vehicle&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> myCar1: some Vehicle = Car()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> myCar2: some Vehicle = Car()
</span></span><span style="display:flex;"><span>myCar2 = myCar1 <span style="color:#75715e">// 🔴 Compile error: Cannot assign value of type &#39;some Vehicle&#39; (type of &#39;myCar1&#39;) to type &#39;some Vehicle&#39; (type of &#39;myCar2&#39;)</span>
</span></span></code></pre></div><ul>
<li><a href="https://swiftsenpai.com/swift/understanding-some-and-any/">Understanding the &ldquo;some&rdquo; and &ldquo;any&rdquo; keywords in Swift 5.7 - Swift Senpai</a></li>
<li><a href="https://reintech.io/blog/understanding-using-swifts-opaque-types">How to use Swift&rsquo;s opaque types | Reintech media</a></li>
</ul>
<h2 id="6-result-builders">6. Result Builders<a href="#6-result-builders" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">makeSentence1</span>() -&gt; String { 
</span></span><span style="display:flex;"><span>     <span style="color:#75715e">// single expression, implicit return</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Why settle for a Duke when you can have a Prince?&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(makeSentence1())
</span></span></code></pre></div><p>That works great, but what if had several strings we wanted to join together? Just like SwiftUI, we might want to provide them all individually and have Swift figure it out, however this kind of code won’t work:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#75715e">// This is invalid Swift, and will not compile.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// func makeSentence2() -&gt; String {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//     &#34;Why settle for a Duke&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//     &#34;when you can have&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//     &#34;a Prince?&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// }</span>
</span></span></code></pre></div><p>By itself, that code won’t work because Swift no longer understands what we mean. However, we could create a result builder that understands how to convert several strings into one string using whatever transformation we want, like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>@resultBuilder
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">SimpleStringBuilder</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">buildBlock</span>(<span style="color:#66d9ef">_</span> parts: String...) -&gt; String {
</span></span><span style="display:flex;"><span>        parts.joined(separator: <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>There’s nothing to stop us from using <code>SimpleStringBuilder.buildBlock()</code> directly, like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> joined = SimpleStringBuilder.buildBlock(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Why settle for a Duke&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;when you can have&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;a Prince?&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(joined)
</span></span></code></pre></div><p>However, because we used the <code>@resultBuilder</code> annotation with our <code>SimpleStringBuilder</code> struct, we can also apply that to functions, like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-swift" data-lang="swift"><span style="display:flex;"><span>@SimpleStringBuilder <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">makeSentence3</span>() -&gt; String {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Why settle for a Duke&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;when you can have&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;a Prince?&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(makeSentence3())
</span></span></code></pre></div><p>References: <a href="https://www.hackingwithswift.com/swift/5.4/result-builders">Result builders – available from Swift 5.4</a></p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">查看其他文章</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="https://blog.jiyi27.com/posts/ios/swift/002-functions/" class="button inline prev">
        Swift Functions
      </a>
    
    
      ::
    
    
      <a href="https://blog.jiyi27.com/posts/frontend/styling-css/000-css-basics/" class="button inline next">
        HTML Elements
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/jiyi27/jiyi27.github.io" target="_blank">Theme</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
