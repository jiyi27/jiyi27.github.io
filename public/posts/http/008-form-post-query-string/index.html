<!DOCTYPE html>
<html lang="en">
<head>
  
    
    <title>Form Data &amp; Query String :: 为霜的博客</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="1. Form data vs query string 1.1. Client side Query string resides in the url:
http://www.blabla.com?a=1&amp;b=2 Form data is sent with the request body. Therefore, when there is sensitive data, we usually put data in the form not the query string. Because the requested URL might show up in Web server logs and browser history/bookmarks which is not a good thing. source
1.2. Server side 1.2.1. Go web For all requests, ParseForm() parses the raw query from the URL and updates r.Form. For POST, PUT, and PATCH requests, it also reads the request body, parses it as a form and puts the results into both r.PostForm and r.Form. When the Content-Type is not application/x-www-form-urlencoded, the request Body is not read.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://blog.jiyi27.com/posts/http/008-form-post-query-string/" />





  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/categories.min.3202f75cbb294747099af3850a68a09ee94b3ce505fc39e134692d90ff0a9b2a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/code.min.dd73d157e77e82a3dc1cb06ba424cf6cc6811af0bb604ad6c68e70faf2439c8a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/main.min.3fb8954e26342ad3afabb4525959bfec6f9fc0d6929f0dda738ddeee30211690.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/menu.min.8cee75f73b9f9b1e40bd0dd53e6e770156b08bbfe1c579cd256c3f6cd3b6d32b.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/post.min.014a50745fbdd41d5f420a3e288730d5af4b7d90344dc6211d0e50c368b5b303.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/prism.min.b958d3d7c6c67361b945f9062d07d403422604b3d2cd33f93b88d41ed0ba634d.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/term.min.94de320c1b850e126e6d2c88a7c90acf58bb1313f0ea14a14cda2a42f2a88db2.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="https://blog.jiyi27.com/terminal.css">




<link rel="shortcut icon" href="https://blog.jiyi27.com/favicon.png">
<link rel="apple-touch-icon" href="https://blog.jiyi27.com/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Form Data &amp; Query String">
<meta property="og:description" content="1. Form data vs query string 1.1. Client side Query string resides in the url:
http://www.blabla.com?a=1&amp;b=2 Form data is sent with the request body. Therefore, when there is sensitive data, we usually put data in the form not the query string. Because the requested URL might show up in Web server logs and browser history/bookmarks which is not a good thing. source
1.2. Server side 1.2.1. Go web For all requests, ParseForm() parses the raw query from the URL and updates r.Form. For POST, PUT, and PATCH requests, it also reads the request body, parses it as a form and puts the results into both r.PostForm and r.Form. When the Content-Type is not application/x-www-form-urlencoded, the request Body is not read.
" />
<meta property="og:url" content="https://blog.jiyi27.com/posts/http/008-form-post-query-string/" />
<meta property="og:site_name" content="为霜的博客" />

  <meta property="og:image" content="https://blog.jiyi27.com/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="http" />


  <meta property="article:published_time" content="2023-11-04 00:02:19 &#43;0000 UTC" />












</head>
<body>


<div class="container center">

  
  
  

  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://blog.jiyi27.com/posts/http/008-form-post-query-string/">Form Data &amp; Query String</a>
  </h1>
  <div class="post-meta"><time class="post-date">2023-11-04</time><span class="post-reading-time">4 分钟阅读 (818 字数)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://blog.jiyi27.com/tags/http/">http</a>&nbsp;
      
      #<a href="https://blog.jiyi27.com/tags/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/">后端开发</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h2 id="1-form-data-vs-query-string">1. Form data vs query string<a href="#1-form-data-vs-query-string" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<h3 id="11-client-side">1.1. Client side<a href="#11-client-side" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Query string resides in the url:</p>
<pre tabindex="0"><code>http://www.blabla.com?a=1&amp;b=2
</code></pre><p>Form data is sent with the request body. Therefore, when there is sensitive data, we usually put data in the form not the query string. Because the requested URL might show up in <strong>Web server logs</strong> and <strong>browser history/bookmarks</strong> which is not a good thing. <a href="https://stackoverflow.com/a/830092/16317008">source</a></p>
<h3 id="12-server-side">1.2. Server side<a href="#12-server-side" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<h4 id="121-go-web">1.2.1. Go web<a href="#121-go-web" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<p>For all requests, <code>ParseForm()</code> parses the <strong>raw query</strong> from the URL and updates r.Form. For POST, PUT, and PATCH requests, <strong>it also reads the request body</strong>, parses it as a form and puts the results into both r.PostForm and r.Form. When the <code>Content-Type</code> is not application/x-www-form-urlencoded, the request Body is not read.</p>
<p>Learn more: <a href="https://davidzhu.xyz/post/golang/practice/012-http-related/#4-parse-form-and-query-string">Some HTTP Issues with Go - David&rsquo;s Blog</a></p>
<h4 id="122-spring-web">1.2.2. Spring web<a href="#122-spring-web" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<p>If your server is wiritten in Java Spring, and you need to POST form data to the server, you need to set your <code>Content-Type</code> header of your request to <code>application/json</code>.</p>
<p>When we write test we usually use <code>curl</code> command, looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl localhost:8080/hello -d <span style="color:#e6db74">&#39;{&#34;username&#34;:&#34;davidzhu&#34;, &#34;password&#34;:&#34;778899a&#34;}&#39;</span>
</span></span></code></pre></div><p>However, this command with <code>-d</code> option will set <code>Content-Type</code> header to <code>application/x-www-form-urlencoded</code>  by default, which is not accepted on Spring&rsquo;s side.</p>
<p>Therefore you have to set <code>Content-Type</code> explicitly:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl localhost:8080/postbody 
</span></span><span style="display:flex;"><span>		-d <span style="color:#e6db74">&#39;{&#34;username&#34;:&#34;davidzhu&#34;, &#34;password&#34;:&#34;778899a&#34;}&#39;</span> 
</span></span><span style="display:flex;"><span>		-H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span>
</span></span></code></pre></div><p>Note the format of the <code>-d</code> is josn format not url query string format: <code>&quot;username=davidzhu&amp;password=778899a&quot;</code>, this format is <code>application/x-www-form-urlencoded</code>, not <code>application/json</code>.</p>
<p>Source: <a href="https://stackoverflow.com/a/7173011/16317008">https://stackoverflow.com/a/7173011/16317008</a></p>
<p>Learn more about curl post: <a href="https://reqbin.com/req/c-dwjszac0/curl-post-json-example">https://reqbin.com/req/c-dwjszac0/curl-post-json-example</a></p>
<h2 id="2-post-data-to-server">2. POST data to server<a href="#2-post-data-to-server" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>The <strong>HTTP <code>POST</code> method</strong> sends data to the server. The type of the body of the request is indicated by the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> header.</p>
<p>A <code>POST</code> request is typically sent via an <a href="https://developer.mozilla.org/en-US/docs/Learn/Forms">HTML form</a> and results in a change on the server. In this case, the content type is selected by putting the adequate string in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#enctype"><code>enctype</code></a> attribute of the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form"><code>form</code></a>  element or the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#formenctype"><code>formenctype</code></a> attribute of the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input"><code>input</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button"><code>button</code></a> elements:</p>
<p><img src="/008-form-post-query-string/cc.png" alt="cc"></p>
<p>References: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST">https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST</a></p>
<h2 id="3-post-data-to-server---example">3. POST data to server - example<a href="#3-post-data-to-server---example" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Let&rsquo;s say there is a html file looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://localhost:8080/postform&#34;</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post&#34;</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-example&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-example&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;username&#34;</span>&gt;username&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;usernam&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;username&#34;</span> <span style="color:#a6e22e">required</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-example&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;password&#34;</span>&gt;password&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;passwor&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#a6e22e">required</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-example&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;register&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">form</span>&gt;
</span></span></code></pre></div><p>When I click the regiser buttion to submit the form, the http request looks like this:</p>
<p><img src="/008-form-post-query-string/c.png" alt="c"></p>
<p><img src="/008-form-post-query-string/d.png" alt="d"></p>
<p>As you can see <strong>the form data resides in the request body, not in the URL.</strong></p>
<p>Sometimes you send data to server with query string <strong>or</strong> with form. Although, data in this two cases reside in different places, former located in the URL, latter at the payload (request body), these two cases may result same thing (the server will get same data), which may give you a wrong impression that form data wil be put into URL too.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl -X POST localhost:8080/postform -d <span style="color:#e6db74">&#34;username=davidzhu&amp;password=778899a&#34;</span> 
</span></span><span style="display:flex;"><span>$ curl -X POST <span style="color:#e6db74">&#34;localhost:8080/postform?username=david&amp;password=778899a&#34;</span>
</span></span></code></pre></div><p>The server may get same data for these two command, this is because the server may try to parse the query string and form data at the same time, I have talked this in <a href="https://davidzhu.xyz/post/golang/practice/012-http-related/#4-parse-form-and-query-string">previous post</a>.</p>
<h2 id="4-form-data-restriction">4. Form data restriction<a href="#4-form-data-restriction" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>As we talk above, form data can only be these three type by by default:<code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code>, <code>text/plain</code>, and you have to set the <code>Content-Type</code> to the corresponding type with correct format.</p>
<p>If you want <code>application/json</code> type, you need encode the form data into josn at client and decode the request body at server side. Besides, don&rsquo;t forget to set the <code>Content-Type</code> header to <code>application/json</code> which will tell the server the data format resides in the request body.</p>
<p><a href="https://stackoverflow.com/a/22195153/16317008">An answer</a> from stackoverflow, hope it will help:</p>
<p><strong>HTML provides no way to generate JSON from form data</strong>. If you really want to handle it from the client, then you would have to resort to using JavaScript to:</p>
<ol>
<li>gather your data from the form via DOM</li>
<li>organise it in an object or array</li>
<li>generate JSON with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">JSON.stringify</a></li>
<li>POST it with <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest">XMLHttpRequest</a></li>
</ol>
<p>You&rsquo;d probably be better off sticking to <code>application/x-www-form-urlencoded</code> data and processing that on the server instead of JSON. Your form doesn&rsquo;t have any complicated hierarchy that would benefit from a JSON data structure.</p>
<p>This is same in Go, if you want send json data in the request body, you should encode it into bytes and decode request body at server:</p>
<p>client:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// string in back quote is raw string which means</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// the double quote here will lose its special meaning</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// decode the json string into </span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">reader_json</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">NewReader</span>(<span style="color:#e6db74">`{&#34;username&#34;: &#34;david&#34;, &#34;password&#34;: &#34;my_password&#34;}`</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">r</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">NewRequest</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">MethodPost</span>, <span style="color:#e6db74">&#34;/postbody&#34;</span>, <span style="color:#a6e22e">reader_json</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;application/json&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div><p>server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Parse username and password in form.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">info</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Username</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;username&#34;`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Password</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;password&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">user</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">info</span>{}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// note that r.Body is an io.Reader</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// which means decoder.Decode() method will consume data stroed in r.Body</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// you cannot read same data twice</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">decoder</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">NewDecoder</span>(<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Body</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">decoder</span>.<span style="color:#a6e22e">Decode</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">password</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">username</span>)
</span></span></code></pre></div>
      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">查看其他文章</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="https://blog.jiyi27.com/posts/http/004-http-v2-binary-frame/" class="button inline prev">
        HTTP 2.0 (Binary Frame, Server Push, Header Compression)
      </a>
    
    
      ::
    
    
      <a href="https://blog.jiyi27.com/posts/http/004-http-versions/" class="button inline next">
        HTTP 1.1 vs HTTP 2.0
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/jiyi27/jiyi27.github.io" target="_blank">Theme</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
