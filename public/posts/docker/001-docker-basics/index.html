<!DOCTYPE html>
<html lang="en">
<head>
  
    
    <title>Docker Basics :: 为霜的博客</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="1. Dockerfile example FROM golang:alpine WORKDIR /app COPY ./ ./ RUN go mod download RUN go build -o server ENTRYPOINT [&#34;./server&#34;] CMD [&#34;-p&#34;, &#34;80&#34;] # docker build [--platform linux/amd64] -t shwezhu/file-server:v1.0 . # [docker push shwezhu/file-server:v1.0] # [docker pull davidzhu/file-server:v1.0] # sudo docker run -d -p 80:80 --rm shwezhu/file-server:v1.0 2. Docker commands #-------------- build and delete image -------------- $ docker build -t davidzhu/go-learning:v1.0 . $ docker rmi shwezhu/file-station:v1	# if docker is in-use, delete with -f $ docker rm container_id # docker run 用于创建一个新的容器并在其中运行一个命令 # specify the container name, if not specified, generate a name for running contianer $ docker run --name mysql-volume ... # --rm automatically removes the container when it exits, # -d: Run container in background $ docker run -d -p 80:80 --rm file-server # docker exec 用于在已经运行的容器中执行命令 # run a contianer, &#39;file-server&#39; is the container name, not image $ docker exec -it file-server bash # specify&#39;bash&#39; as the shell of container $ docker exec -it file-server /bin/sh # specify &#39;/bin/sh&#39; as the shell of container # publish and pull image from repo $ docker push shwezhu/file-station:v1 $ docker pull davidzhu/file-station:v1 #-------------------- show info ------------------------ $ docker container ls -a $ docker image ls -a # check the output of the program running in the container $ docker logs container_name # volumes, mount the folder on the machine &#39;~/root&#39; to the &#39;/app/root&#39; dir of the container $ docker run --name file-server --rm -d -p 80:80 -v ~/root:/app/root shwezhu/file-server:v1.0 ./server -p 80 3. Build image The docker build command is used to build a Docker image from a Dockerfile and a &ldquo;context&rdquo;.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://blog.jiyi27.com/posts/docker/001-docker-basics/" />





  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/categories.min.3202f75cbb294747099af3850a68a09ee94b3ce505fc39e134692d90ff0a9b2a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/code.min.dd73d157e77e82a3dc1cb06ba424cf6cc6811af0bb604ad6c68e70faf2439c8a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/main.min.3fb8954e26342ad3afabb4525959bfec6f9fc0d6929f0dda738ddeee30211690.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/menu.min.8cee75f73b9f9b1e40bd0dd53e6e770156b08bbfe1c579cd256c3f6cd3b6d32b.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/post.min.014a50745fbdd41d5f420a3e288730d5af4b7d90344dc6211d0e50c368b5b303.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/prism.min.b958d3d7c6c67361b945f9062d07d403422604b3d2cd33f93b88d41ed0ba634d.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/term.min.94de320c1b850e126e6d2c88a7c90acf58bb1313f0ea14a14cda2a42f2a88db2.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="https://blog.jiyi27.com/terminal.css">




<link rel="shortcut icon" href="https://blog.jiyi27.com/favicon.png">
<link rel="apple-touch-icon" href="https://blog.jiyi27.com/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Docker Basics">
<meta property="og:description" content="1. Dockerfile example FROM golang:alpine WORKDIR /app COPY ./ ./ RUN go mod download RUN go build -o server ENTRYPOINT [&#34;./server&#34;] CMD [&#34;-p&#34;, &#34;80&#34;] # docker build [--platform linux/amd64] -t shwezhu/file-server:v1.0 . # [docker push shwezhu/file-server:v1.0] # [docker pull davidzhu/file-server:v1.0] # sudo docker run -d -p 80:80 --rm shwezhu/file-server:v1.0 2. Docker commands #-------------- build and delete image -------------- $ docker build -t davidzhu/go-learning:v1.0 . $ docker rmi shwezhu/file-station:v1	# if docker is in-use, delete with -f $ docker rm container_id # docker run 用于创建一个新的容器并在其中运行一个命令 # specify the container name, if not specified, generate a name for running contianer $ docker run --name mysql-volume ... # --rm automatically removes the container when it exits, # -d: Run container in background $ docker run -d -p 80:80 --rm file-server # docker exec 用于在已经运行的容器中执行命令 # run a contianer, &#39;file-server&#39; is the container name, not image $ docker exec -it file-server bash # specify&#39;bash&#39; as the shell of container $ docker exec -it file-server /bin/sh # specify &#39;/bin/sh&#39; as the shell of container # publish and pull image from repo $ docker push shwezhu/file-station:v1 $ docker pull davidzhu/file-station:v1 #-------------------- show info ------------------------ $ docker container ls -a $ docker image ls -a # check the output of the program running in the container $ docker logs container_name # volumes, mount the folder on the machine &#39;~/root&#39; to the &#39;/app/root&#39; dir of the container $ docker run --name file-server --rm -d -p 80:80 -v ~/root:/app/root shwezhu/file-server:v1.0 ./server -p 80 3. Build image The docker build command is used to build a Docker image from a Dockerfile and a &ldquo;context&rdquo;.
" />
<meta property="og:url" content="https://blog.jiyi27.com/posts/docker/001-docker-basics/" />
<meta property="og:site_name" content="为霜的博客" />

  <meta property="og:image" content="https://blog.jiyi27.com/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="docker" />


  <meta property="article:published_time" content="2023-10-09 21:09:35 &#43;0000 UTC" />












</head>
<body>


<div class="container center">

  
  
  

  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://blog.jiyi27.com/posts/docker/001-docker-basics/">Docker Basics</a>
  </h1>
  <div class="post-meta"><time class="post-date">2023-10-09</time><span class="post-reading-time">5 分钟阅读 (881 字数)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://blog.jiyi27.com/tags/docker/">docker</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h2 id="1-dockerfile-example">1. Dockerfile example<a href="#1-dockerfile-example" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> golang:alpine</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">WORKDIR</span><span style="color:#e6db74"> /app</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> ./ ./<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> go mod download<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> go build -o server<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENTRYPOINT</span> [<span style="color:#e6db74">&#34;./server&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;-p&#34;</span>, <span style="color:#e6db74">&#34;80&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># docker build [--platform linux/amd64] -t shwezhu/file-server:v1.0 .</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># [docker push shwezhu/file-server:v1.0]</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># [docker pull davidzhu/file-server:v1.0]</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># sudo docker run -d -p 80:80 --rm shwezhu/file-server:v1.0</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><h2 id="2-docker-commands">2. Docker commands<a href="#2-docker-commands" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#-------------- build and delete image --------------</span>
</span></span><span style="display:flex;"><span>$ docker build -t davidzhu/go-learning:v1.0 .
</span></span><span style="display:flex;"><span>$ docker rmi shwezhu/file-station:v1	<span style="color:#75715e"># if docker is in-use, delete with -f</span>
</span></span><span style="display:flex;"><span>$ docker rm container_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># docker run 用于创建一个新的容器并在其中运行一个命令</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># specify the container name, if not specified, generate a name for running contianer</span>
</span></span><span style="display:flex;"><span>$ docker run --name mysql-volume ...
</span></span><span style="display:flex;"><span><span style="color:#75715e"># --rm automatically removes the container when it exits,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -d: Run container in background</span>
</span></span><span style="display:flex;"><span>$ docker run -d -p 80:80 --rm file-server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># docker exec 用于在已经运行的容器中执行命令</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># run a contianer, &#39;file-server&#39; is the container name, not image</span>
</span></span><span style="display:flex;"><span>$ docker exec -it file-server bash <span style="color:#75715e"># specify&#39;bash&#39; as the shell of container</span>
</span></span><span style="display:flex;"><span>$ docker exec -it file-server /bin/sh <span style="color:#75715e"># specify &#39;/bin/sh&#39; as the shell of container</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># publish and pull image from repo</span>
</span></span><span style="display:flex;"><span>$ docker push shwezhu/file-station:v1
</span></span><span style="display:flex;"><span>$ docker pull davidzhu/file-station:v1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-------------------- show info ------------------------</span>
</span></span><span style="display:flex;"><span>$ docker container ls -a
</span></span><span style="display:flex;"><span>$ docker image ls -a
</span></span><span style="display:flex;"><span><span style="color:#75715e"># check the output of the program running in the container</span>
</span></span><span style="display:flex;"><span>$ docker logs container_name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># volumes, mount the folder on the machine &#39;~/root&#39; to the &#39;/app/root&#39; dir of the container</span>
</span></span><span style="display:flex;"><span>$ docker run --name file-server --rm -d -p 80:80 -v ~/root:/app/root shwezhu/file-server:v1.0 ./server -p <span style="color:#ae81ff">80</span> 
</span></span></code></pre></div><h2 id="3-build-image">3. Build image<a href="#3-build-image" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>The <code>docker build</code> command is used to build a Docker image from a Dockerfile and a &ldquo;context&rdquo;.</p>
<p>During the build, those files (build context) are sent to the Docker <strong>daemon</strong> so that the <strong>image</strong> can use them as files. The <strong>build context</strong> is usually at the current folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># -t image_name:tag_name</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># . specifies the build context as the current directory</span>
</span></span><span style="display:flex;"><span>$ docker build -t go-learning:1 . 
</span></span></code></pre></div><blockquote>
<p>Learn more: <a href="https://docs.docker.com/build/building/multi-stage/">Multi-stage builds | Docker Docs</a></p>
</blockquote>
<h2 id="4-dockerignore-file">4. <code>.dockerignore</code> File<a href="#4-dockerignore-file" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>During the build, those files (build context) are sent to the Docker <strong>daemon</strong> so that the <strong>image</strong> can use them as files.</p>
<p>When you build a Docker image, Docker takes all the files and directories in the build context and sends them to the Docker daemon, which then processes and includes them in the image. By using a <code>.dockerignore</code> file, you can specify patterns of files and directories that should be ignored during the build process.</p>
<p>By excluding unnecessary files and directories, you can significantly <strong>reduce the size of the Docker image</strong>. This is particularly important when building images for production environments or when transferring images across networks.</p>
<h2 id="5-image-vs-container">5. Image vs container<a href="#5-image-vs-container" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p><strong>A container is an isolated place</strong> where an application runs without affecting the rest of the system and without the system impacting the application. Because they are isolated, containers are well-suited for securely running software like databases or web applications that need access to sensitive resources without giving access to every user on the system. However, containers can be much more efficient than virtual machines because they don’t need the overhead of an entire operating system. They share a single kernel with other containers and boot in seconds instead of minutes.</p>
<p><strong>Images are read-only templates</strong> containing instructions for creating a container. A Docker image creates containers to run on the Docker platform. Docker images are immutable, so you cannot change them once they are created. If you need to change something, create another container with your changes, then save those as another image. Or, just run your new container using an existing image as a base and change that one.</p>
<p>An image is composed of multiple stacked layers, like layers in a photo editor, each changing something in the environment. Images contain the code or binary, runtimes, dependencies, and other filesystem objects to run an application. The image relies on the host operating system (OS) kernel. For example, to build a web server image, start with an image that includes Ubuntu Linux (a base OS). Then, add packages like Apache and PHP on top.</p>
<p><strong>Think of a Docker container as a running image instance</strong>. You can create many containers from the same image, each with its own unique data and state. Although images are not the only way to create containers, they are a common method.</p>
<p>Source: <a href="https://circleci.com/blog/docker-image-vs-container/">Docker image vs container: What are the differences? | CircleCI</a></p>
<h2 id="6-image-with-cross-platform">6. Image with cross platform<a href="#6-image-with-cross-platform" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Docker images are typically built for a specific CPU architecture, such as x86-64 (64-bit Intel/AMD processors). By default, Docker images are built for the architecture of the system where the image is built. However, it is possible to build and run Docker images for different architectures using a technique called multi-architecture or cross-platform support.</p>
<p><strong>Docker images can support multiple platforms</strong>, which means that a single image may contain variants for different architectures, and sometimes for different operating systems, such as Windows. When you run an image with multi-platform support, Docker automatically selects the image that matches your OS and architecture.</p>
<p>Most of the Docker Official Images on Docker Hub provide a <a href="https://github.com/docker-library/official-images#architectures-other-than-amd64">variety of architecturesopen_in_new</a>. For example, the <code>busybox</code> image supports <code>amd64</code>, <code>arm32v5</code>, <code>arm32v6</code>, <code>arm32v7</code>, <code>arm64v8</code>, <code>i386</code>, <code>ppc64le</code>, and <code>s390x</code>. When running this image on an <code>x86_64</code> / <code>amd64</code> machine, the <code>amd64</code> variant is pulled and run.</p>
<p>Learn more: <a href="https://docs.docker.com/build/building/multi-platform/">Multi-platform images | Docker Docs</a></p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">查看其他文章</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="https://blog.jiyi27.com/posts/golang/advance/011-cross-compilation/" class="button inline prev">
        Cross Compilation - Go
      </a>
    
    
      ::
    
    
      <a href="https://blog.jiyi27.com/posts/build-website/006-ufw-aws-sg/" class="button inline next">
        ufw vs  AWS Security Group
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/jiyi27/jiyi27.github.io" target="_blank">Theme</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
