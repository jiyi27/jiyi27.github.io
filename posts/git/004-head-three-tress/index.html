<!DOCTYPE html>
<html lang="en">
<head>
  
    
    <title>HEAD and Three Trees - Git :: 为霜的博客</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="1. Three trees Git as a system manages and manipulates three trees in its normal operation:
Tree Role HEAD Last commit snapshot, next parent Index Proposed next commit snapshot Working Directory Sandbox The Git index is a critical data structure in Git. It serves as the “staging area” between the files you have on your filesystem and your commit history. When you run git add, the files from your working directory are hashed and stored as objects in the index, leading them to be “staged changes”. When you run git commit, the staged changes as stored in the index are used to create that new commit.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://blog.jiyi27.com/posts/git/004-head-three-tress/" />





  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/categories.min.3202f75cbb294747099af3850a68a09ee94b3ce505fc39e134692d90ff0a9b2a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/code.min.dd73d157e77e82a3dc1cb06ba424cf6cc6811af0bb604ad6c68e70faf2439c8a.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/main.min.3fb8954e26342ad3afabb4525959bfec6f9fc0d6929f0dda738ddeee30211690.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/menu.min.8cee75f73b9f9b1e40bd0dd53e6e770156b08bbfe1c579cd256c3f6cd3b6d32b.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/post.min.014a50745fbdd41d5f420a3e288730d5af4b7d90344dc6211d0e50c368b5b303.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/prism.min.b958d3d7c6c67361b945f9062d07d403422604b3d2cd33f93b88d41ed0ba634d.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/term.min.94de320c1b850e126e6d2c88a7c90acf58bb1313f0ea14a14cda2a42f2a88db2.css">

  
  <link rel="stylesheet" href="https://blog.jiyi27.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="https://blog.jiyi27.com/terminal.css">




<link rel="shortcut icon" href="https://blog.jiyi27.com/favicon.png">
<link rel="apple-touch-icon" href="https://blog.jiyi27.com/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="HEAD and Three Trees - Git">
<meta property="og:description" content="1. Three trees Git as a system manages and manipulates three trees in its normal operation:
Tree Role HEAD Last commit snapshot, next parent Index Proposed next commit snapshot Working Directory Sandbox The Git index is a critical data structure in Git. It serves as the “staging area” between the files you have on your filesystem and your commit history. When you run git add, the files from your working directory are hashed and stored as objects in the index, leading them to be “staged changes”. When you run git commit, the staged changes as stored in the index are used to create that new commit.
" />
<meta property="og:url" content="https://blog.jiyi27.com/posts/git/004-head-three-tress/" />
<meta property="og:site_name" content="为霜的博客" />

  <meta property="og:image" content="https://blog.jiyi27.com/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="git" />


  <meta property="article:published_time" content="2023-09-15 10:18:30 &#43;0000 UTC" />












</head>
<body>


<div class="container center">

  
  
  

  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://blog.jiyi27.com/posts/git/004-head-three-tress/">HEAD and Three Trees - Git</a>
  </h1>
  <div class="post-meta"><time class="post-date">2023-09-15</time><span class="post-reading-time">3 分钟阅读 (502 字数)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://blog.jiyi27.com/tags/git/">git</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h2 id="1-three-trees">1. Three trees<a href="#1-three-trees" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Git as a system manages and manipulates three trees in its normal operation:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Tree</th>
          <th style="text-align: left">Role</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">HEAD</td>
          <td style="text-align: left">Last commit snapshot, next parent</td>
      </tr>
      <tr>
          <td style="text-align: left">Index</td>
          <td style="text-align: left">Proposed next commit snapshot</td>
      </tr>
      <tr>
          <td style="text-align: left">Working Directory</td>
          <td style="text-align: left">Sandbox</td>
      </tr>
  </tbody>
</table>
<p>The Git index is a critical data structure in Git. It serves as the “staging area” between the files you have on your filesystem and your commit history. When you run <code>git add</code>, the files from your working directory are hashed and stored as objects in the index, leading them to be “staged changes”. When you run <code>git commit</code>, the staged changes as stored in the index are used to create that new commit.</p>
<h2 id="2-head">2. HEAD<a href="#2-head" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<h3 id="21-head-is-you">2.1. HEAD is YOU<a href="#21-head-is-you" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>HEAD</code>is a symbolic reference pointing to wherever you are in your commit history. It follows you wherever you go, whatever you do, like a shadow. If you make a commit, <code>HEAD</code> will move. If you checkout something, <code>HEAD</code> will move. Whatever you do, if you have moved somewhere new in your commit history, <code>HEAD</code> has moved along with you. To address one common misconception: you cannot detach yourself from <code>HEAD</code>. That is not what a detached HEAD state is. If you ever find yourself thinking: &ldquo;oh no, i&rsquo;m in detached HEAD state! I&rsquo;ve lost my HEAD!&rdquo; Remember, it&rsquo;s your HEAD. HEAD is you. You haven&rsquo;t detached from the HEAD, you and your HEAD have detached from something else.</p>
<p>Acutally, HEAD is just a special pointer that points to the <strong>local branch</strong> you’re currently on.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat .git/HEAD                 
</span></span><span style="display:flex;"><span>ref: refs/heads/hugo-blog
</span></span></code></pre></div><p>Sometimes you&rsquo;ll get something like this:</p>
<pre tabindex="0"><code>a3c485d9688e3c6bc14b06ca1529f0e78edd3f86
</code></pre><p>That&rsquo;s what happens when <code>HEAD</code> points directly to a commit. This is called a detached HEAD, because <code>HEAD</code> is pointing to something other than a branch reference.</p>
<blockquote>
<p>In Git, HEAD refers to the currently checked-out branch’s latest commit. However, in a <em>detached</em> HEAD state, the HEAD does not point to any branch, but instead points to a <strong>specific commit</strong> or the <strong>remote repository</strong>.</p>
</blockquote>
<h3 id="22-what-can-head-attach-to">2.2. What can HEAD attach to?<a href="#22-what-can-head-attach-to" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p><code>HEAD</code> can point to a commit, yes, but typically it does not. Let me say that again. Typically <code>HEAD</code> does not point to a commit. It points to a branch reference. It is <em>attached</em> to that branch, and when you do certain things (e.g., <code>commit</code> or <a href="https://stackoverflow.com/a/54934887/7936744"><code>reset</code></a>), the attached branch will move along with <code>HEAD</code>.</p>
<p><code>HEAD</code> is you. It points to whatever you checked out, wherever you are. <strong>Typically that is not a commit, it is a local branch.</strong> If <code>HEAD</code> <em>does</em> point to a commit (or tag), even if it&rsquo;s the same commit (or tag) that a branch also points to, you (and <code>HEAD</code>) have been detached from that branch. Since you don&rsquo;t have a branch attached to you, the branch won&rsquo;t follow along with you as you make new commits. The <code>HEAD</code>, however, will.</p>
<pre><code>&lt;div style=&quot;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&quot;&gt;
  &lt;iframe allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; allowfullscreen=&quot;allowfullscreen&quot; loading=&quot;eager&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; src=&quot;https://www.youtube.com/embed/GN36mrrM12k?autoplay=0&amp;amp;controls=1&amp;amp;end=0&amp;amp;loop=0&amp;amp;mute=0&amp;amp;start=0&quot; style=&quot;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&quot; title=&quot;YouTube video&quot;&gt;&lt;/iframe&gt;
&lt;/div&gt;
</code></pre>
<p>Source:</p>
<p><a href="https://stackoverflow.com/a/54935492/16317008">https://stackoverflow.com/a/54935492/16317008</a></p>
<p><a href="https://circleci.com/blog/git-detached-head-state/">https://circleci.com/blog/git-detached-head-state/</a></p>
<p><a href="https://youtu.be/GN36mrrM12k?si=S6_VTBQDZgG_fHre">https://youtu.be/GN36mrrM12k?si=S6_VTBQDZgG_fHre</a></p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">查看其他文章</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="https://blog.jiyi27.com/posts/git/005-git-rebase-merge/" class="button inline prev">
        git merge vs git rebase
      </a>
    
    
      ::
    
    
      <a href="https://blog.jiyi27.com/posts/networking/001-wireshark/" class="button inline next">
        Wireshark Basics
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/jiyi27/jiyi27.github.io" target="_blank">Theme</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
